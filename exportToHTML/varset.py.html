<html>
<head>
<title>varset.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #629755; font-style: italic;}
.s1 { color: #a9b7c6;}
.s2 { color: #808080;}
.s3 { color: #cc7832;}
.s4 { color: #6a8759;}
.s5 { color: #6897bb;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
varset.py</font>
</center></td></tr></table>
<pre><span class="s0">&quot;&quot;&quot;VarSet is used when you need to acess some non-constant variable that could 
have been modified by the user through the GUI interface during execution. 
&quot;&quot;&quot;</span>

<span class="s2">##from collections import namedtuple</span>

<span class="s3">from </span><span class="s1">thorpy._utils.functions </span><span class="s3">import </span><span class="s1">obtain_valid_object</span>
<span class="s3">from </span><span class="s1">thorpy.elements.slidersetter </span><span class="s3">import </span><span class="s1">SliderXSetter</span>
<span class="s3">from </span><span class="s1">thorpy.elements.inserter </span><span class="s3">import </span><span class="s1">Inserter</span>
<span class="s3">from </span><span class="s1">thorpy.elements.checker </span><span class="s3">import </span><span class="s1">Checker</span>
<span class="s3">from </span><span class="s1">thorpy.elements.colorsetter </span><span class="s3">import </span><span class="s1">ColorSetter</span>
<span class="s3">from </span><span class="s1">thorpy.elements.launchers.colorsetterlauncher </span><span class="s3">import </span><span class="s1">ColorSetterLauncher</span>
<span class="s3">from </span><span class="s1">thorpy.elements.browser </span><span class="s3">import </span><span class="s1">Browser</span>
<span class="s3">from </span><span class="s1">thorpy.elements.browserlight </span><span class="s3">import </span><span class="s1">BrowserLight</span>
<span class="s3">from </span><span class="s1">thorpy.elements.paramsetter </span><span class="s3">import </span><span class="s1">ParamSetter</span>
<span class="s3">from </span><span class="s1">thorpy.elements.launchers.dropdownlistlauncher </span><span class="s3">import </span><span class="s1">DropDownListLauncher</span>
<span class="s3">from </span><span class="s1">thorpy.miscgui </span><span class="s3">import </span><span class="s1">constants</span>


<span class="s3">def </span><span class="s1">get_handler_for(variable):</span>
    <span class="s1">type_ = type(variable.value)</span>
    <span class="s1">value = variable.value</span>
    <span class="s1">text = variable.text</span>
    <span class="s1">limits = variable.limits</span>
    <span class="s1">handler_type = variable.handler_type</span>
    <span class="s1">more = variable.more</span>
    <span class="s1">handler = </span><span class="s3">None</span>
    <span class="s3">if </span><span class="s1">handler_type:</span>
        <span class="s3">if </span><span class="s1">handler_type == </span><span class="s4">&quot;color choice&quot;</span><span class="s1">:</span>
<span class="s2">##            cs = ColorSetter(text=text, value=value)</span>
            <span class="s1">handler = ColorSetterLauncher(value</span><span class="s3">, </span><span class="s1">text)</span>
        <span class="s3">elif </span><span class="s1">handler_type == </span><span class="s4">&quot;file choice&quot;</span><span class="s1">:</span>
            <span class="s1">limits.setdefault(</span><span class="s4">&quot;launcher&quot;</span><span class="s3">, False</span><span class="s1">)</span>
            <span class="s1">limits.setdefault(</span><span class="s4">&quot;light&quot;</span><span class="s3">, True</span><span class="s1">)</span>
            <span class="s1">limits.setdefault(</span><span class="s4">&quot;ddl_size&quot;</span><span class="s3">, None</span><span class="s1">)</span>
            <span class="s1">limits.setdefault(</span><span class="s4">&quot;folders&quot;</span><span class="s3">, True</span><span class="s1">)</span>
            <span class="s1">limits.setdefault(</span><span class="s4">&quot;file_types&quot;</span><span class="s3">, None</span><span class="s1">)</span>
            <span class="s1">limits.setdefault(</span><span class="s4">&quot;files&quot;</span><span class="s3">, True</span><span class="s1">)</span>
            <span class="s3">if </span><span class="s1">limits[</span><span class="s4">&quot;light&quot;</span><span class="s1">]:</span>
                <span class="s1">handler = BrowserLight(text=text</span><span class="s3">, </span><span class="s1">path=value</span><span class="s3">,</span>
                                     <span class="s1">ddl_size=limits[</span><span class="s4">&quot;ddl_size&quot;</span><span class="s1">]</span><span class="s3">,</span>
                                     <span class="s1">folders=limits[</span><span class="s4">&quot;folders&quot;</span><span class="s1">]</span><span class="s3">,</span>
                                     <span class="s1">files=limits[</span><span class="s4">&quot;files&quot;</span><span class="s1">]</span><span class="s3">,</span>
                                     <span class="s1">file_types=limits[</span><span class="s4">&quot;file_types&quot;</span><span class="s1">])</span>
            <span class="s3">else</span><span class="s1">:</span>
                <span class="s1">handler = Browser(text=text</span><span class="s3">, </span><span class="s1">path=value</span><span class="s3">,</span>
                                 <span class="s1">ddl_size=limits[</span><span class="s4">&quot;ddl_size&quot;</span><span class="s1">]</span><span class="s3">,</span>
                                 <span class="s1">folders=limits[</span><span class="s4">&quot;folders&quot;</span><span class="s1">]</span><span class="s3">,</span>
                                 <span class="s1">files=limits[</span><span class="s4">&quot;files&quot;</span><span class="s1">]</span><span class="s3">,</span>
                                 <span class="s1">file_types=limits[</span><span class="s4">&quot;file_types&quot;</span><span class="s1">])</span>
        <span class="s3">else</span><span class="s1">:</span>
            <span class="s1">handler = obtain_valid_object(handler_type</span><span class="s3">, </span><span class="s1">value=value</span><span class="s3">, </span><span class="s1">type_=type_</span><span class="s3">,</span>
                                          <span class="s1">text=text</span><span class="s3">, </span><span class="s1">limits=limits)</span>
    <span class="s3">elif </span><span class="s1">type_ </span><span class="s3">is </span><span class="s1">tuple:</span>
        <span class="s3">if </span><span class="s1">len(value) == </span><span class="s5">3</span><span class="s1">:</span>
<span class="s2">##            handler = ColorSetter(text=text, value=value)</span>
            <span class="s1">handler = ColorSetterLauncher(value</span><span class="s3">, </span><span class="s1">text</span><span class="s3">, </span><span class="s1">finish=</span><span class="s3">False</span><span class="s1">)</span>
    <span class="s3">elif </span><span class="s1">type_ </span><span class="s3">is </span><span class="s1">list:</span>
        <span class="s1">var_text = more.get(</span><span class="s4">&quot;var_text&quot;</span><span class="s3">, </span><span class="s1">value[</span><span class="s5">0</span><span class="s1">])</span>
        <span class="s1">ddlf_size = more.get(</span><span class="s4">&quot;ddlf_size&quot;</span><span class="s3">, </span><span class="s4">&quot;auto&quot;</span><span class="s1">)</span>
        <span class="s1">handler = DropDownListLauncher(const_text=text</span><span class="s3">, </span><span class="s1">var_text=var_text</span><span class="s3">,</span>
                                        <span class="s1">titles=value</span><span class="s3">, </span><span class="s1">ddlf_size=ddlf_size</span><span class="s3">,</span>
                                        <span class="s1">finish=</span><span class="s3">False</span><span class="s1">)</span>
    <span class="s3">elif </span><span class="s1">((type_ </span><span class="s3">is </span><span class="s1">str) </span><span class="s3">or not</span><span class="s1">(limits)) </span><span class="s3">and not</span><span class="s1">(type_ </span><span class="s3">is </span><span class="s1">bool):</span>
        <span class="s3">if not</span><span class="s1">(limits) </span><span class="s3">or </span><span class="s1">isinstance(limits</span><span class="s3">,</span><span class="s1">str):</span>
            <span class="s1">ilimits = (</span><span class="s3">None, None</span><span class="s1">)</span>
        <span class="s3">else</span><span class="s1">:</span>
            <span class="s1">ilimits = limits</span>
        <span class="s1">handler = Inserter(text</span><span class="s3">, </span><span class="s1">value=str(value)</span><span class="s3">, </span><span class="s1">value_type=type_</span><span class="s3">,</span>
                            <span class="s1">size=ilimits</span><span class="s3">, </span><span class="s1">finish=</span><span class="s3">False</span><span class="s1">)</span>
        <span class="s3">if </span><span class="s1">limits == </span><span class="s4">&quot;float&quot;</span><span class="s1">:</span>
            <span class="s1">handler.numeric_only = </span><span class="s3">True</span>
            <span class="s1">handler.int_only = </span><span class="s3">False</span>
            <span class="s1">handler._value_type = float</span>
        <span class="s3">elif </span><span class="s1">limits == </span><span class="s4">&quot;int&quot;</span><span class="s1">:</span>
            <span class="s1">handler.numeric_only = </span><span class="s3">True</span>
            <span class="s1">handler.int_only = </span><span class="s3">True</span>
            <span class="s1">handler._value_type = int</span>
    <span class="s3">elif </span><span class="s1">(type_ </span><span class="s3">is </span><span class="s1">int) </span><span class="s3">or </span><span class="s1">(type_ </span><span class="s3">is </span><span class="s1">float):</span>
        <span class="s1">length = more.get(</span><span class="s4">&quot;length&quot;</span><span class="s3">, </span><span class="s5">100</span><span class="s1">)</span>
        <span class="s1">handler = SliderXSetter(length</span><span class="s3">,</span>
                                <span class="s1">limits</span><span class="s3">,</span>
                                <span class="s1">text</span><span class="s3">,</span>
                                <span class="s1">type_=type_</span><span class="s3">,</span>
                                <span class="s1">initial_value=value</span><span class="s3">,</span>
                                <span class="s1">finish=</span><span class="s3">False</span><span class="s1">)</span>
    <span class="s3">elif </span><span class="s1">type_ </span><span class="s3">is </span><span class="s1">bool:</span>
        <span class="s1">handler = Checker(variable.text</span><span class="s3">, </span><span class="s1">value=variable.value</span><span class="s3">, </span><span class="s1">finish=</span><span class="s3">False</span><span class="s1">)</span>
    <span class="s3">if </span><span class="s1">handler:</span>
        <span class="s1">handler.rank = variable.rank</span>
        <span class="s3">return </span><span class="s1">handler</span>
    <span class="s3">else</span><span class="s1">:</span>
        <span class="s3">raise </span><span class="s1">Exception(</span>
            <span class="s4">&quot;Variable doesn't have default handler: &quot; </span><span class="s1">+</span>
            <span class="s1">str(text))</span>

<span class="s3">class </span><span class="s1">Variable(object):</span>
    <span class="s0">&quot;&quot;&quot;Basic type for Varsetter's variables.&quot;&quot;&quot;</span>

    <span class="s3">def </span><span class="s1">__init__(self</span><span class="s3">, </span><span class="s1">value</span><span class="s3">, </span><span class="s1">text</span><span class="s3">, </span><span class="s1">limits</span><span class="s3">, </span><span class="s1">handler_type</span><span class="s3">, </span><span class="s1">rank</span><span class="s3">, </span><span class="s1">help_text</span><span class="s3">, </span><span class="s1">more):</span>
        <span class="s1">self.value = value</span>
        <span class="s1">self.text = text</span>
        <span class="s1">self.limits = limits</span>
        <span class="s1">self.handler_type = handler_type</span>
        <span class="s1">self.rank = rank</span>
        <span class="s1">self.help_text = help_text</span>
        <span class="s1">self.more = more</span>

    <span class="s3">def </span><span class="s1">set_value(self</span><span class="s3">, </span><span class="s1">value):</span>
        <span class="s1">self.value = value</span>

    <span class="s3">def </span><span class="s1">get_value(self):</span>
        <span class="s3">return </span><span class="s1">self.value</span>


<span class="s3">class </span><span class="s1">LinkedVariable(Variable):</span>
    <span class="s0">&quot;&quot;&quot;Use this if you need to link an object's variable to the Varsetter.&quot;&quot;&quot;</span>

    <span class="s3">def </span><span class="s1">__init__(self</span><span class="s3">, </span><span class="s1">father</span><span class="s3">, </span><span class="s1">name</span><span class="s3">, </span><span class="s1">text</span><span class="s3">, </span><span class="s1">limits</span><span class="s3">, </span><span class="s1">handler_type</span><span class="s3">, </span><span class="s1">rank</span><span class="s3">,</span>
                    <span class="s1">help_text):</span>
        <span class="s1">father_value = getattr(father</span><span class="s3">, </span><span class="s1">name)</span>
        <span class="s1">Variable.__init__(self</span><span class="s3">, </span><span class="s1">father_value</span><span class="s3">, </span><span class="s1">text</span><span class="s3">, </span><span class="s1">limits</span><span class="s3">, </span><span class="s1">handler_type</span><span class="s3">, </span><span class="s1">rank</span><span class="s3">,</span>
                            <span class="s1">help_text)</span>
        <span class="s1">self.father = father</span>
        <span class="s1">self.name = name</span>

    <span class="s3">def </span><span class="s1">set_value(self</span><span class="s3">, </span><span class="s1">value):</span>
        <span class="s1">Variable.set_value(self</span><span class="s3">, </span><span class="s1">value)</span>
        <span class="s1">setattr(self.father</span><span class="s3">, </span><span class="s1">self.name</span><span class="s3">, </span><span class="s1">value)</span>


<span class="s3">class </span><span class="s1">FuncLauncher(Variable):</span>
    <span class="s0">&quot;&quot;&quot;Use this if you need to execute a function just after setting the value. 
    &quot;&quot;&quot;</span>

    <span class="s3">def </span><span class="s1">__init__(</span>
            <span class="s1">self</span><span class="s3">,</span>
            <span class="s1">func</span><span class="s3">,</span>
            <span class="s1">dictargs</span><span class="s3">,</span>
            <span class="s1">value</span><span class="s3">,</span>
            <span class="s1">text</span><span class="s3">,</span>
            <span class="s1">limits</span><span class="s3">,</span>
            <span class="s1">handler_type</span><span class="s3">,</span>
            <span class="s1">rank</span><span class="s3">,</span>
            <span class="s1">help_text):</span>
        <span class="s1">Variable.__init__(self</span><span class="s3">, </span><span class="s1">value</span><span class="s3">, </span><span class="s1">text</span><span class="s3">, </span><span class="s1">limits</span><span class="s3">, </span><span class="s1">handler_type</span><span class="s3">, </span><span class="s1">rank</span><span class="s3">, </span><span class="s1">help_text)</span>
        <span class="s1">self.func = func</span>
        <span class="s1">self.dictargs = dictargs</span>


<span class="s3">class </span><span class="s1">PostFuncLauncher(FuncLauncher):</span>

    <span class="s3">def </span><span class="s1">set_value(self</span><span class="s3">, </span><span class="s1">value):</span>
        <span class="s1">Variable.set_value(self</span><span class="s3">, </span><span class="s1">value)</span>
        <span class="s1">self.func(self.dictargs)</span>


<span class="s3">class </span><span class="s1">PreFuncLauncher(FuncLauncher):</span>

    <span class="s3">def </span><span class="s1">set_value(self</span><span class="s3">, </span><span class="s1">value):</span>
        <span class="s1">self.func(self.dictargs)</span>
        <span class="s1">Variable.set_value(self</span><span class="s3">, </span><span class="s1">value)</span>


<span class="s3">class </span><span class="s1">VarSet(object):</span>
    <span class="s0">&quot;&quot;&quot;Dynamically creates attributes so that one can acess them as if they were 
    variables of a module. 
    &quot;&quot;&quot;</span>

    <span class="s1">EXCEPTION_TEXT = </span><span class="s4">&quot;Tried to name a variable like a built-in attribute&quot;</span><span class="s1">+\</span>
                      <span class="s4">&quot; or method. Please use the syntax hack provided by&quot;</span><span class="s1">+\</span>
                      <span class="s4">&quot; thorpy. It is also possible that you try to add a&quot;</span><span class="s1">+\</span>
                      <span class="s4">&quot; key that already exist. In that case use the method&quot;</span><span class="s1">+\</span>
                      <span class="s4">&quot; set_variable of this object.&quot;&quot;&quot;</span>

    <span class="s3">def </span><span class="s1">__init__(self</span><span class="s3">, </span><span class="s1">variables=</span><span class="s3">None</span><span class="s1">):</span>
        <span class="s3">if not </span><span class="s1">variables:</span>
            <span class="s1">variables = {}</span>
        <span class="s1">self.variables = variables</span>
        <span class="s1">self._current_rank = -</span><span class="s5">1</span>

    <span class="s3">def </span><span class="s1">add(self</span><span class="s3">, </span><span class="s1">varname</span><span class="s3">, </span><span class="s1">value</span><span class="s3">, </span><span class="s1">text</span><span class="s3">, </span><span class="s1">limits=</span><span class="s3">None, </span><span class="s1">handler_type=</span><span class="s3">None,</span>
            <span class="s1">rank=</span><span class="s3">None, </span><span class="s1">help_text=</span><span class="s3">None, </span><span class="s1">more=</span><span class="s3">None</span><span class="s1">):</span>
        <span class="s1">rank = self._get_rank() </span><span class="s3">if </span><span class="s1">rank </span><span class="s3">is None else </span><span class="s1">rank</span>
        <span class="s3">if </span><span class="s1">more </span><span class="s3">is None </span><span class="s1">: more = {}</span>
        <span class="s3">if not </span><span class="s1">varname </span><span class="s3">in </span><span class="s1">self.__dict__:</span>
            <span class="s1">v = Variable(value</span><span class="s3">, </span><span class="s1">text</span><span class="s3">, </span><span class="s1">limits</span><span class="s3">, </span><span class="s1">handler_type</span><span class="s3">, </span><span class="s1">rank</span><span class="s3">, </span><span class="s1">help_text</span><span class="s3">, </span><span class="s1">more)</span>
            <span class="s1">self.variables[varname] = v</span>
            <span class="s1">self.__dict__[varname] = v.get_value()</span>
        <span class="s3">else</span><span class="s1">:</span>
            <span class="s3">raise </span><span class="s1">Exception(VarSet.EXCEPTION_TEXT)</span>

    <span class="s3">def </span><span class="s1">add_link(self</span><span class="s3">, </span><span class="s1">varname</span><span class="s3">, </span><span class="s1">obj</span><span class="s3">, </span><span class="s1">text</span><span class="s3">, </span><span class="s1">limits=</span><span class="s3">None, </span><span class="s1">handler_type=</span><span class="s3">None,</span>
                 <span class="s1">rank=</span><span class="s3">None, </span><span class="s1">help_text=</span><span class="s3">None, </span><span class="s1">more=</span><span class="s3">None</span><span class="s1">):</span>
        <span class="s0">&quot;&quot;&quot;Use this if you need to link an object's variable to the Varsetter. 
        &quot;&quot;&quot;</span>
        <span class="s1">rank = self._get_rank() </span><span class="s3">if </span><span class="s1">rank </span><span class="s3">is None else </span><span class="s1">rank</span>
        <span class="s3">if </span><span class="s1">more </span><span class="s3">is None </span><span class="s1">: more = {}</span>
        <span class="s3">if not </span><span class="s1">varname </span><span class="s3">in </span><span class="s1">self.__dict__:</span>
            <span class="s1">v = LinkedVariable(obj</span><span class="s3">, </span><span class="s1">varname</span><span class="s3">, </span><span class="s1">text</span><span class="s3">, </span><span class="s1">limits</span><span class="s3">, </span><span class="s1">handler_type</span><span class="s3">, </span><span class="s1">rank</span><span class="s3">,</span>
                                <span class="s1">help_text</span><span class="s3">, </span><span class="s1">more)</span>
            <span class="s1">self.variables[varname] = v</span>
            <span class="s1">self.__dict__[varname] = v.get_value()</span>
        <span class="s3">else</span><span class="s1">:</span>
            <span class="s3">raise </span><span class="s1">Exception(VarSet.EXCEPTION_TEXT)</span>

    <span class="s3">def </span><span class="s1">add_func(self</span><span class="s3">, </span><span class="s1">varname</span><span class="s3">, </span><span class="s1">func</span><span class="s3">, </span><span class="s1">dictargs</span><span class="s3">, </span><span class="s1">value</span><span class="s3">, </span><span class="s1">text</span><span class="s3">, </span><span class="s1">limits=</span><span class="s3">None,</span>
                 <span class="s1">handler_type=</span><span class="s3">None, </span><span class="s1">rank=</span><span class="s3">None, </span><span class="s1">post=</span><span class="s3">True, </span><span class="s1">help_text=</span><span class="s3">None,</span>
                 <span class="s1">more=</span><span class="s3">None</span><span class="s1">):</span>
        <span class="s0">&quot;&quot;&quot;Use this if you need to execute a function just before/after 
        setting the value. 
        &quot;&quot;&quot;</span>
        <span class="s1">rank = self._get_rank() </span><span class="s3">if </span><span class="s1">rank </span><span class="s3">is None else </span><span class="s1">rank</span>
        <span class="s3">if </span><span class="s1">more </span><span class="s3">is None </span><span class="s1">: more = {}</span>
        <span class="s3">if not </span><span class="s1">varname </span><span class="s3">in </span><span class="s1">self.__dict__:</span>
            <span class="s3">if </span><span class="s1">post:</span>
                <span class="s1">v = PostFuncLauncher(</span>
                    <span class="s1">func</span><span class="s3">,</span>
                    <span class="s1">dictargs</span><span class="s3">,</span>
                    <span class="s1">value</span><span class="s3">,</span>
                    <span class="s1">text</span><span class="s3">,</span>
                    <span class="s1">limits</span><span class="s3">,</span>
                    <span class="s1">handler_type</span><span class="s3">,</span>
                    <span class="s1">rank</span><span class="s3">,</span>
                    <span class="s1">help_text</span><span class="s3">,</span>
                    <span class="s1">more)</span>
            <span class="s3">else</span><span class="s1">:</span>
                <span class="s1">v = PreFuncLauncher(</span>
                    <span class="s1">func</span><span class="s3">,</span>
                    <span class="s1">dictargs</span><span class="s3">,</span>
                    <span class="s1">value</span><span class="s3">,</span>
                    <span class="s1">text</span><span class="s3">,</span>
                    <span class="s1">limits</span><span class="s3">,</span>
                    <span class="s1">handler_type</span><span class="s3">,</span>
                    <span class="s1">rank</span><span class="s3">,</span>
                    <span class="s1">help_text</span><span class="s3">,</span>
                    <span class="s1">more)</span>
            <span class="s1">self.variables[varname] = v</span>
            <span class="s1">self.__dict__[varname] = v.get_value()</span>
        <span class="s3">else</span><span class="s1">:</span>
            <span class="s3">raise </span><span class="s1">Exception(VarSet.EXCEPTION_TEXT)</span>

    <span class="s3">def </span><span class="s1">set_value(self</span><span class="s3">, </span><span class="s1">varname</span><span class="s3">, </span><span class="s1">value):</span>
        <span class="s1">self.variables[varname].set_value(value)</span>
        <span class="s1">setattr(self</span><span class="s3">, </span><span class="s1">varname</span><span class="s3">, </span><span class="s1">value)</span>

    <span class="s3">def </span><span class="s1">get_value(self</span><span class="s3">, </span><span class="s1">varname):</span>
        <span class="s3">return </span><span class="s1">self.variables[varname].get_value()</span>

    <span class="s3">def </span><span class="s1">set_variable(self</span><span class="s3">, </span><span class="s1">varname</span><span class="s3">, </span><span class="s1">variable):</span>
        <span class="s1">self.variables[varname] = variable</span>
        <span class="s1">setattr(self</span><span class="s3">, </span><span class="s1">varname</span><span class="s3">, </span><span class="s1">variable.value)</span>

<span class="s2">##    def get_handlers(self):</span>
<span class="s2">##        handlers = {}</span>
<span class="s2">##        for varname in self.variables:</span>
<span class="s2">##            handler = get_handler_for(self.variables[varname])</span>
<span class="s2">##            handlers[varname] = handler</span>
<span class="s2">##        return handlers</span>

    <span class="s3">def </span><span class="s1">get_handlers(self):</span>
        <span class="s1">handlers = {}</span>
        <span class="s3">for </span><span class="s1">varname</span><span class="s3">, </span><span class="s1">variable </span><span class="s3">in </span><span class="s1">self.variables.items():</span>
            <span class="s1">handler = get_handler_for(variable)</span>
            <span class="s1">handlers[varname] = (handler</span><span class="s3">, </span><span class="s1">variable)</span>
        <span class="s3">return </span><span class="s1">handlers</span>

    <span class="s3">def </span><span class="s1">_get_rank(self):</span>
        <span class="s1">self._current_rank += </span><span class="s5">1</span>
        <span class="s3">return </span><span class="s1">self._current_rank</span>

    <span class="s3">def </span><span class="s1">create_paramsetter(self</span><span class="s3">, </span><span class="s1">name_txt=</span><span class="s4">&quot;&quot;</span><span class="s3">, </span><span class="s1">launched_txt=</span><span class="s4">&quot;&quot;</span><span class="s3">, </span><span class="s1">box_els=</span><span class="s3">None</span><span class="s1">):</span>
        <span class="s1">box_els = [] </span><span class="s3">if not </span><span class="s1">box_els </span><span class="s3">else </span><span class="s1">box_els</span>
        <span class="s1">ps = ParamSetter([self]</span><span class="s3">, </span><span class="s1">name_txt</span><span class="s3">, </span><span class="s1">launched_txt</span><span class="s3">, </span><span class="s1">box_els)</span>
        <span class="s1">ps.finish()</span>
        <span class="s3">return </span><span class="s1">ps</span></pre>
</body>
</html>