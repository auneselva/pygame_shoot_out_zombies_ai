<html>
<head>
<title>application.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #629755; font-style: italic;}
.s1 { color: #a9b7c6;}
.s2 { color: #cc7832;}
.s3 { color: #6a8759;}
.s4 { color: #6897bb;}
.s5 { color: #808080;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
application.py</font>
</center></td></tr></table>
<pre><span class="s0">&quot;&quot;&quot;Module defining Application class.&quot;&quot;&quot;</span>
<span class="s2">import </span><span class="s1">os</span>
<span class="s2">import </span><span class="s1">time</span>
<span class="s2">import </span><span class="s1">pygame</span>

<span class="s1">_CURRENT_MENU = </span><span class="s2">None</span>
<span class="s1">_OLD_MENUS = [_CURRENT_MENU]</span>
<span class="s1">_CURRENT_APPLICATION = </span><span class="s2">None</span>
<span class="s1">_SCREEN = </span><span class="s2">None</span>

<span class="s1">DEBUG_MODE = </span><span class="s2">False</span>
<span class="s1">SHOW_FPS = </span><span class="s2">False</span>
<span class="s1">TICK_BUSY = </span><span class="s2">False</span>

<span class="s1">USE_IMG_DICT = </span><span class="s2">False</span>
<span class="s1">_loaded = {}</span>


<span class="s2">class </span><span class="s1">Application(object):</span>
    <span class="s0">&quot;&quot;&quot;An Application object handles the pygame variables needed to create a 
    graphical program, such as screen, screen's size window caption and window 
    location. 
    &quot;&quot;&quot;</span>

    <span class="s2">def </span><span class="s1">__init__(self</span><span class="s2">, </span><span class="s1">size</span><span class="s2">, </span><span class="s1">caption=</span><span class="s2">None, </span><span class="s1">icon=</span><span class="s3">&quot;thorpy&quot;</span><span class="s2">, </span><span class="s1">center=</span><span class="s2">True, </span><span class="s1">flags=</span><span class="s4">0</span><span class="s1">):</span>
        <span class="s0">&quot;&quot;&quot;This object handles the pygame variables needed to create a graphical 
        program, such as screen, screen's size window caption and window 
        location. 
 
        &lt;size&gt; : a 2-sequence containing the size in pixels of the window to 
        create. 
 
        &lt;caption&gt; : the caption of the window. None means no caption. 
 
        &lt;icon&gt; : path to the the icon image of the window. 
            'thorpy' : default thorpy icon 
            'pygame' : default pygame icon 
            None : no icon 
 
        &lt;center&gt; : centers the window on the computer screen. 
 
        &lt;flags&gt; : flags passed to the pygame display surface. They can be: 
            pygame.FULLSCREEN    create a fullscreen display 
            pygame.DOUBLEBUF     recommended for HWSURFACE or OPENGL 
            pygame.HWSURFACE     hardware accelerated, only in FULLSCREEN 
            pygame.OPENGL        create an OpenGL renderable display 
            pygame.RESIZABLE     display window should be sizeable 
            pygame.NOFRAME       display window will have no border or controls 
        &quot;&quot;&quot;</span>
        <span class="s2">global </span><span class="s1">_SCREEN</span><span class="s2">, </span><span class="s1">_CURRENT_APPLICATION</span>
        <span class="s1">_CURRENT_APPLICATION = self</span>
        <span class="s1">self.size = tuple(size)</span>
        <span class="s1">self.caption = caption</span>
        <span class="s1">pygame.init()</span>
        <span class="s2">if </span><span class="s1">center:</span>
            <span class="s1">os.environ[</span><span class="s3">'SDL_VIDEO_CENTERED'</span><span class="s1">] = </span><span class="s3">'1'</span>
        <span class="s1">self.set_icon(icon)</span>
        <span class="s1">w</span><span class="s2">,</span><span class="s1">h = pygame.display.set_mode((</span><span class="s4">0</span><span class="s2">,</span><span class="s4">0</span><span class="s1">)</span><span class="s2">,</span><span class="s1">pygame.FULLSCREEN).get_size()</span>
        <span class="s1">self.max_screen_size = (w</span><span class="s2">,</span><span class="s1">h)</span>
        <span class="s1">screen = pygame.display.set_mode(self.size</span><span class="s2">, </span><span class="s1">flags)</span>
        <span class="s2">if </span><span class="s1">self.caption:</span>
            <span class="s1">pygame.display.set_caption(caption)</span>
        <span class="s1">_SCREEN = screen</span>
        <span class="s1">self.default_path = </span><span class="s3">&quot;./&quot;</span>


    <span class="s2">def </span><span class="s1">set_icon(self</span><span class="s2">, </span><span class="s1">icon):</span>
        <span class="s2">if </span><span class="s1">icon.lower() == </span><span class="s3">&quot;pygame&quot;</span><span class="s1">:</span>
            <span class="s2">pass</span>
        <span class="s2">elif </span><span class="s1">icon.lower() == </span><span class="s3">&quot;thorpy&quot;</span><span class="s1">:</span>
            <span class="s2">from </span><span class="s1">thorpy.miscgui.style </span><span class="s2">import </span><span class="s1">DEFAULT_ICON</span>
            <span class="s1">icon_surf = pygame.image.load(DEFAULT_ICON)</span>
            <span class="s1">pygame.display.set_icon(icon_surf)</span>
        <span class="s2">elif </span><span class="s1">icon:</span>
            <span class="s1">icon_surf = load_image(DEFAULT_ICON)</span>
            <span class="s1">pygame.display.set_icon(icon_surf)</span>
        <span class="s2">else</span><span class="s1">:</span>
            <span class="s1">icon_surf = pygame.Surface((</span><span class="s4">1</span><span class="s2">,</span><span class="s4">1</span><span class="s1">))</span>
            <span class="s1">icon_surf.set_colorkey((</span><span class="s4">0</span><span class="s2">,</span><span class="s4">0</span><span class="s2">,</span><span class="s4">0</span><span class="s1">))</span>
            <span class="s1">pygame.display.set_icon(icon_surf)</span>

    <span class="s2">def </span><span class="s1">update(self):</span>
        <span class="s1">pygame.display.flip()</span>

    <span class="s2">def </span><span class="s1">blit(self</span><span class="s2">, </span><span class="s1">surface</span><span class="s2">, </span><span class="s1">pos):</span>
        <span class="s1">_SCREEN.blit(surface</span><span class="s2">, </span><span class="s1">pos)</span>

    <span class="s2">def </span><span class="s1">fill(self</span><span class="s2">, </span><span class="s1">color):</span>
        <span class="s1">_SCREEN.fill(color)</span>

    <span class="s2">def </span><span class="s1">quit(self):</span>
        <span class="s1">pygame.font.quit()</span>
        <span class="s1">pygame.quit()</span>

    <span class="s2">def </span><span class="s1">pause(self</span><span class="s2">, </span><span class="s1">fps=</span><span class="s4">20</span><span class="s1">):</span>
        <span class="s1">stay = </span><span class="s2">True</span>
        <span class="s1">clock = pygame.time.Clock()</span>
        <span class="s2">while </span><span class="s1">stay:</span>
            <span class="s1">clock.tick(fps)</span>
            <span class="s2">for </span><span class="s1">e </span><span class="s2">in </span><span class="s1">pygame.event.get():</span>
                <span class="s2">if </span><span class="s1">e.type == pygame.constants.QUIT:</span>
                    <span class="s1">pygame.font.quit()</span>
                    <span class="s1">pygame.quit()</span>
                    <span class="s1">exit()</span>
                <span class="s2">elif </span><span class="s1">e.type == pygame.constants.KEYDOWN:</span>
                    <span class="s1">stay = </span><span class="s2">False</span>

    <span class="s2">def </span><span class="s1">pause_until(self</span><span class="s2">, </span><span class="s1">event_type</span><span class="s2">, </span><span class="s1">**event_args):</span>
        <span class="s1">stay = </span><span class="s2">True</span>
        <span class="s1">clock = pygame.time.Clock()</span>
        <span class="s2">from </span><span class="s1">thorpy.miscgui </span><span class="s2">import </span><span class="s1">functions</span><span class="s2">, </span><span class="s1">constants</span>
        <span class="s1">fps = functions.get_current_menu().fps</span>
        <span class="s2">while </span><span class="s1">stay:</span>
            <span class="s1">clock.tick(fps)</span>
            <span class="s2">for </span><span class="s1">e </span><span class="s2">in </span><span class="s1">pygame.event.get():</span>
                <span class="s2">if </span><span class="s1">e.type == pygame.constants.QUIT:</span>
                    <span class="s1">pygame.font.quit()</span>
                    <span class="s1">pygame.quit()</span>
                    <span class="s1">exit()</span>
                <span class="s2">elif </span><span class="s1">e.type == event_type:</span>
                    <span class="s2">if </span><span class="s1">event_args:</span>
                        <span class="s2">for </span><span class="s1">arg </span><span class="s2">in </span><span class="s1">event_args:</span>
                            <span class="s2">if </span><span class="s1">hasattr(e</span><span class="s2">, </span><span class="s1">arg):</span>
                                <span class="s2">if </span><span class="s1">getattr(e</span><span class="s2">, </span><span class="s1">arg) != event_args[arg]:</span>
                                    <span class="s2">break</span>
                            <span class="s2">else</span><span class="s1">:</span>
                                <span class="s2">break</span>
                        <span class="s2">else</span><span class="s1">:</span>
                            <span class="s1">stay = </span><span class="s2">False</span>
                    <span class="s2">else</span><span class="s1">:</span>
                        <span class="s1">stay = </span><span class="s2">False</span>

    <span class="s2">def </span><span class="s1">save_screenshot(self</span><span class="s2">, </span><span class="s1">path=</span><span class="s2">None, </span><span class="s1">name=</span><span class="s2">None, </span><span class="s1">note=</span><span class="s3">&quot;&quot;</span><span class="s1">):</span>
        <span class="s2">from </span><span class="s1">thorpy.miscgui </span><span class="s2">import </span><span class="s1">functions</span>
        <span class="s2">if </span><span class="s1">path </span><span class="s2">is None</span><span class="s1">:</span>
            <span class="s1">path = self.default_path</span>
        <span class="s2">if </span><span class="s1">name </span><span class="s2">is None</span><span class="s1">:</span>
            <span class="s1">name = time.asctime().replace(</span><span class="s3">&quot; &quot;</span><span class="s2">, </span><span class="s3">&quot;_&quot;</span><span class="s1">).replace(</span><span class="s3">&quot;:&quot;</span><span class="s2">, </span><span class="s3">&quot;-&quot;</span><span class="s1">) + </span><span class="s3">&quot;.png&quot;</span>
        <span class="s1">functions.debug_msg(</span><span class="s3">&quot;Saving screenshot as &quot; </span><span class="s1">+ path + note + name)</span>
        <span class="s1">pygame.image.save(functions.get_screen()</span><span class="s2">, </span><span class="s1">path+note+name)</span>

    <span class="s2">def </span><span class="s1">get_statistics(self):</span>
        <span class="s2">from </span><span class="s1">thorpy.elements.ghost </span><span class="s2">import </span><span class="s1">Ghost</span>
        <span class="s2">return </span><span class="s1">{</span><span class="s3">&quot;number of elements&quot;</span><span class="s1">:Ghost._current_id}</span>

    <span class="s2">def </span><span class="s1">get_screen(self): </span><span class="s5">#wrapper</span>
        <span class="s2">from </span><span class="s1">thorpy.miscgui </span><span class="s2">import </span><span class="s1">functions</span>
        <span class="s2">return </span><span class="s1">functions.get_screen()</span>
</pre>
</body>
</html>