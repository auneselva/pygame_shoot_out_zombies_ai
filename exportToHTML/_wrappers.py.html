<html>
<head>
<title>_wrappers.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cc7832;}
.s1 { color: #a9b7c6;}
.s2 { color: #6a8759;}
.s3 { color: #808080;}
.s4 { color: #629755; font-style: italic;}
.s5 { color: #6897bb;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
_wrappers.py</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s1">pygame</span>

<span class="s0">from </span><span class="s1">thorpy.painting.writer </span><span class="s0">import </span><span class="s1">Writer</span>
<span class="s0">from </span><span class="s1">thorpy.elements.element </span><span class="s0">import </span><span class="s1">Element</span>
<span class="s0">from </span><span class="s1">thorpy.elements.clickable </span><span class="s0">import </span><span class="s1">Clickable</span>
<span class="s0">from </span><span class="s1">thorpy.elements.ghost </span><span class="s0">import </span><span class="s1">Ghost</span>
<span class="s0">from </span><span class="s1">thorpy.elements.box </span><span class="s0">import </span><span class="s1">Box</span>
<span class="s0">from </span><span class="s1">thorpy.elements.inserter </span><span class="s0">import </span><span class="s1">Inserter</span>
<span class="s0">from </span><span class="s1">thorpy.miscgui.storage </span><span class="s0">import </span><span class="s1">store</span>
<span class="s0">from </span><span class="s1">thorpy.miscgui </span><span class="s0">import </span><span class="s1">constants</span><span class="s0">, </span><span class="s1">style</span><span class="s0">, </span><span class="s1">functions</span>
<span class="s0">from </span><span class="s1">thorpy.painting.painters.imageframe </span><span class="s0">import </span><span class="s1">ButtonImage</span>
<span class="s0">import </span><span class="s1">thorpy.painting.graphics </span><span class="s0">as </span><span class="s1">graphics</span>

<span class="s0">def </span><span class="s1">make_textbox(text</span><span class="s0">, </span><span class="s1">font_size=</span><span class="s0">None, </span><span class="s1">font_color=</span><span class="s0">None, </span><span class="s1">ok_text=</span><span class="s2">&quot;Ok&quot;</span><span class="s1">):</span>
    <span class="s0">if </span><span class="s1">font_size </span><span class="s0">is None</span><span class="s1">: font_size = style.FONT_SIZE</span>
    <span class="s0">if </span><span class="s1">font_color </span><span class="s0">is None</span><span class="s1">: font_color = style.FONT_COLOR</span>
    <span class="s0">from </span><span class="s1">thorpy.miscgui.launchers.launcher </span><span class="s0">import </span><span class="s1">make_ok_box</span>
    <span class="s1">e_text = make_text(text</span><span class="s0">, </span><span class="s1">font_size</span><span class="s0">, </span><span class="s1">font_color)</span>
    <span class="s1">box = make_ok_box([e_text]</span><span class="s0">, </span><span class="s1">ok_text=ok_text)</span>
    <span class="s0">return </span><span class="s1">box</span>

<span class="s3">##def launch_blocking_alert(text, parent=None, font_size=None, font_color=None,</span>
<span class="s3">##                            ok_text=&quot;Ok&quot;):</span>
<span class="s3">##    if font_size is None: font_size = style.FONT_SIZE</span>
<span class="s3">##    if font_color is None: font_color = style.FONT_COLOR</span>
<span class="s3">##    box_alert = make_textbox(text, font_size, font_color, ok_text)</span>
<span class="s3">##    box_alert.center()</span>
<span class="s3">##    from thorpy.menus.tickedmenu import TickedMenu</span>
<span class="s3">##    m = TickedMenu(box_alert)</span>
<span class="s3">##    box_alert.get_elements_by_text(ok_text)[0].user_func = functions.quit_menu_func</span>
<span class="s3">##    box_alert.get_elements_by_text(ok_text)[0].user_params = {}</span>
<span class="s3">##    m.play()</span>
<span class="s3">##    box_alert.unblit()</span>
<span class="s3">##    if parent:</span>
<span class="s3">##        parent.partial_blit(None, box_alert.get_fus_rect())</span>
<span class="s3">##        box_alert.update()</span>

<span class="s0">def </span><span class="s1">launch_alert(text</span><span class="s0">, </span><span class="s1">font_size=</span><span class="s0">None, </span><span class="s1">font_color=</span><span class="s0">None, </span><span class="s1">ok_text=</span><span class="s2">&quot;Ok&quot;</span><span class="s1">):</span>
    <span class="s0">if </span><span class="s1">font_size </span><span class="s0">is None</span><span class="s1">: font_size = style.FONT_SIZE</span>
    <span class="s0">if </span><span class="s1">font_color </span><span class="s0">is None</span><span class="s1">: font_color = style.FONT_COLOR</span>
    <span class="s0">from </span><span class="s1">thorpy.miscgui.launchers.launcher </span><span class="s0">import </span><span class="s1">launch</span>
    <span class="s1">box_alert = make_textbox(text</span><span class="s0">, </span><span class="s1">font_size</span><span class="s0">, </span><span class="s1">font_color</span><span class="s0">, </span><span class="s1">ok_text)</span>
    <span class="s1">box_alert.center()</span>
    <span class="s1">launch(box_alert)</span>

<span class="s0">def </span><span class="s1">launch_choices(text</span><span class="s0">, </span><span class="s1">choices</span><span class="s0">, </span><span class="s1">title_fontsize=</span><span class="s0">None, </span><span class="s1">title_fontcolor=</span><span class="s0">None</span><span class="s1">):</span>
    <span class="s4">&quot;&quot;&quot;choices are tuple (text,func)&quot;&quot;&quot;</span>
    <span class="s0">if </span><span class="s1">title_fontsize </span><span class="s0">is None</span><span class="s1">: title_fontsize = style.FONT_SIZE</span>
    <span class="s0">if </span><span class="s1">title_fontcolor </span><span class="s0">is None</span><span class="s1">: title_fontcolor = style.FONT_COLOR</span>
<span class="s3">##    elements = [make_button(t,f) for t,f in choices]</span>
    <span class="s1">elements = []</span>
    <span class="s0">for </span><span class="s1">choice </span><span class="s0">in </span><span class="s1">choices:</span>
        <span class="s0">if </span><span class="s1">isinstance(choice</span><span class="s0">, </span><span class="s1">tuple):</span>
            <span class="s1">elements.append(make_button(choice[</span><span class="s5">0</span><span class="s1">]</span><span class="s0">,</span><span class="s1">choice[</span><span class="s5">1</span><span class="s1">]))</span>
        <span class="s0">else</span><span class="s1">:</span>
            <span class="s1">elements.append(choice)</span>
    <span class="s1">ghost = make_stored_ghost(elements)</span>
    <span class="s1">e_text = make_text(text</span><span class="s0">, </span><span class="s1">title_fontsize</span><span class="s0">, </span><span class="s1">title_fontcolor)</span>
    <span class="s1">box = Box.make([e_text</span><span class="s0">, </span><span class="s1">ghost])</span>
    <span class="s1">box.center()</span>
    <span class="s0">from </span><span class="s1">thorpy.miscgui.launchers.launcher </span><span class="s0">import </span><span class="s1">launch</span>
    <span class="s0">from </span><span class="s1">thorpy.miscgui.reaction </span><span class="s0">import </span><span class="s1">ConstantReaction</span>
    <span class="s1">launcher = launch(box)</span>
    <span class="s0">for </span><span class="s1">e </span><span class="s0">in </span><span class="s1">elements:</span>
        <span class="s1">reac = ConstantReaction(constants.THORPY_EVENT</span><span class="s0">,</span>
                                <span class="s1">launcher.unlaunch</span><span class="s0">,</span>
                                <span class="s1">{</span><span class="s2">&quot;id&quot;</span><span class="s1">:constants.EVENT_UNPRESS</span><span class="s0">, </span><span class="s2">&quot;el&quot;</span><span class="s1">:e}</span><span class="s0">,</span>
                                <span class="s1">{</span><span class="s2">&quot;what&quot;</span><span class="s1">:</span><span class="s0">None</span><span class="s1">})</span>
        <span class="s1">box.add_reaction(reac)</span>
    <span class="s0">return </span><span class="s1">launcher</span>

<span class="s0">def </span><span class="s1">launch_blocking_choices(text</span><span class="s0">, </span><span class="s1">choices</span><span class="s0">, </span><span class="s1">parent=</span><span class="s0">None, </span><span class="s1">title_fontsize=</span><span class="s0">None,</span>
                    <span class="s1">title_fontcolor=</span><span class="s0">None, </span><span class="s1">main_color=</span><span class="s0">None</span><span class="s1">):</span>
    <span class="s4">&quot;&quot;&quot;choices is a list of either tuple(text,func) or elements&quot;&quot;&quot;</span>
    <span class="s0">if </span><span class="s1">title_fontsize </span><span class="s0">is None</span><span class="s1">: title_fontsize = style.FONT_SIZE</span>
    <span class="s0">if </span><span class="s1">title_fontcolor </span><span class="s0">is None</span><span class="s1">: title_fontcolor = style.FONT_COLOR</span>
<span class="s3">##    elements = [make_button(t,f) for t,f in choices] #old form</span>
    <span class="s1">elements = []</span>
    <span class="s0">for </span><span class="s1">choice </span><span class="s0">in </span><span class="s1">choices:</span>
        <span class="s0">if </span><span class="s1">isinstance(choice</span><span class="s0">, </span><span class="s1">tuple):</span>
            <span class="s1">elements.append(make_button(choice[</span><span class="s5">0</span><span class="s1">]</span><span class="s0">,</span><span class="s1">choice[</span><span class="s5">1</span><span class="s1">]))</span>
        <span class="s0">else</span><span class="s1">:</span>
            <span class="s1">elements.append(choice)</span>
    <span class="s1">ghost = make_stored_ghost(elements)</span>
    <span class="s1">e_text = make_text(text</span><span class="s0">, </span><span class="s1">title_fontsize</span><span class="s0">, </span><span class="s1">title_fontcolor)</span>
    <span class="s1">box = Box.make([e_text</span><span class="s0">, </span><span class="s1">ghost])</span>
    <span class="s0">if </span><span class="s1">main_color:</span>
        <span class="s1">box.set_main_color(main_color)</span>
    <span class="s1">box.center()</span>
    <span class="s0">from </span><span class="s1">thorpy.miscgui.reaction </span><span class="s0">import </span><span class="s1">ConstantReaction</span>
    <span class="s0">for </span><span class="s1">e </span><span class="s0">in </span><span class="s1">elements:</span>
        <span class="s1">reac = ConstantReaction(constants.THORPY_EVENT</span><span class="s0">,</span>
                                <span class="s1">functions.quit_menu_func</span><span class="s0">,</span>
                                <span class="s1">{</span><span class="s2">&quot;id&quot;</span><span class="s1">:constants.EVENT_UNPRESS</span><span class="s0">,</span>
                                 <span class="s2">&quot;el&quot;</span><span class="s1">:e})</span>
        <span class="s1">box.add_reaction(reac)</span>
    <span class="s0">from </span><span class="s1">thorpy.menus.tickedmenu </span><span class="s0">import </span><span class="s1">TickedMenu</span>
    <span class="s1">m = TickedMenu(box)</span>
    <span class="s1">m.play()</span>
    <span class="s1">box.unblit()</span>
    <span class="s0">if </span><span class="s1">parent:</span>
        <span class="s1">parent.partial_blit(</span><span class="s0">None, </span><span class="s1">box.get_fus_rect())</span>
        <span class="s1">box.update()</span>

<span class="s0">def </span><span class="s1">launch_binary_choice(title_text</span><span class="s0">, </span><span class="s1">parent=</span><span class="s0">None, </span><span class="s1">title_fontsize=</span><span class="s0">None,</span>
                    <span class="s1">title_fontcolor=</span><span class="s0">None, </span><span class="s1">main_color=</span><span class="s0">None, </span><span class="s1">yes_text=</span><span class="s2">&quot;Yes&quot;</span><span class="s0">,</span>
                    <span class="s1">no_text=</span><span class="s2">&quot;No&quot;</span><span class="s0">, </span><span class="s1">blocking=</span><span class="s0">True</span><span class="s1">):</span>
    <span class="s4">&quot;&quot;&quot;Use &lt;blocking&gt; argument to decide wether or not the launch is blocking&quot;&quot;&quot;</span>
    <span class="s0">class </span><span class="s1">Choice:</span>
        <span class="s1">value = </span><span class="s0">False</span>
    <span class="s0">def </span><span class="s1">yes():</span>
        <span class="s1">Choice.value = </span><span class="s0">True</span>
    <span class="s1">choices = [(yes_text</span><span class="s0">,</span><span class="s1">yes)</span><span class="s0">, </span><span class="s1">(no_text</span><span class="s0">,None</span><span class="s1">)]</span>
    <span class="s0">if </span><span class="s1">blocking:</span>
        <span class="s1">launch_blocking_choices(title_text</span><span class="s0">, </span><span class="s1">choices</span><span class="s0">, </span><span class="s1">parent</span><span class="s0">, </span><span class="s1">title_fontsize</span><span class="s0">, </span><span class="s1">title_fontcolor</span><span class="s0">, </span><span class="s1">main_color)</span>
    <span class="s0">else</span><span class="s1">:</span>
        <span class="s1">launch_choices(title_text</span><span class="s0">, </span><span class="s1">choices</span><span class="s0">, </span><span class="s1">parent</span><span class="s0">, </span><span class="s1">title_fontsize</span><span class="s0">, </span><span class="s1">title_fontcolor</span><span class="s0">, </span><span class="s1">main_color)</span>
    <span class="s0">return </span><span class="s1">Choice.value</span>

<span class="s0">def </span><span class="s1">launch_inserter(title_text</span><span class="s0">, </span><span class="s1">initial_value=</span><span class="s2">&quot;&quot;</span><span class="s0">, </span><span class="s1">parent=</span><span class="s0">None, </span><span class="s1">title_fontsize=</span><span class="s0">None,</span>
                    <span class="s1">title_fontcolor=</span><span class="s0">None, </span><span class="s1">main_color=</span><span class="s0">None, </span><span class="s1">blocking=</span><span class="s0">True</span><span class="s1">):</span>
    <span class="s0">from </span><span class="s1">thorpy.miscgui.launchers.launcher </span><span class="s0">import </span><span class="s1">make_ok_box</span><span class="s0">, </span><span class="s1">auto_ok</span><span class="s0">, </span><span class="s1">launch_blocking</span>
    <span class="s1">ins = Inserter.make(title_text</span><span class="s0">, </span><span class="s1">value=initial_value)</span>
    <span class="s1">ins.center()</span>
    <span class="s1">ins.enter()</span>
    <span class="s1">launch_blocking(ins)</span>
    <span class="s1">parent.unblit_and_reblit()</span>
    <span class="s0">return </span><span class="s1">ins.get_value()</span>

<span class="s0">def </span><span class="s1">make_stored_ghost(elements</span><span class="s0">, </span><span class="s1">mode=</span><span class="s2">&quot;h&quot;</span><span class="s1">):</span>
    <span class="s1">ghost = Ghost(elements)</span>
    <span class="s1">store(ghost</span><span class="s0">, </span><span class="s1">mode=mode)</span>
    <span class="s1">ghost.fit_children()</span>
    <span class="s0">return </span><span class="s1">ghost</span>


<span class="s0">def </span><span class="s1">make_button(text</span><span class="s0">, </span><span class="s1">func=</span><span class="s0">None, </span><span class="s1">params=</span><span class="s0">None</span><span class="s1">):</span>
    <span class="s1">button = Clickable(text)</span>
    <span class="s1">button.scale_to_title()</span>
    <span class="s0">if </span><span class="s1">func:</span>
        <span class="s1">button.user_func = func</span>
    <span class="s0">if </span><span class="s1">params:</span>
        <span class="s1">button.user_params = params</span>
    <span class="s0">return </span><span class="s1">button</span>

<span class="s0">def </span><span class="s1">make_image_button(img_normal</span><span class="s0">, </span><span class="s1">img_pressed=</span><span class="s0">None, </span><span class="s1">img_hover=</span><span class="s0">None,</span>
                        <span class="s1">alpha=</span><span class="s5">255</span><span class="s0">, </span><span class="s1">colorkey=</span><span class="s0">None, </span><span class="s1">text=</span><span class="s2">&quot;&quot;</span><span class="s1">):</span>
    <span class="s1">e = Clickable(text</span><span class="s0">,</span><span class="s1">finish=</span><span class="s0">False</span><span class="s1">)</span>
    <span class="s1">painter = ButtonImage(img_normal</span><span class="s0">, </span><span class="s1">img_pressed</span><span class="s0">, </span><span class="s1">img_hover</span><span class="s0">, </span><span class="s1">alpha</span><span class="s0">, </span><span class="s1">colorkey)</span>
    <span class="s1">e.set_painter(painter)</span>
    <span class="s1">e.finish()</span>
    <span class="s0">return </span><span class="s1">e</span>

<span class="s0">def </span><span class="s1">make_image_button_with_frame(img_normal</span><span class="s0">, </span><span class="s1">img_pressed=</span><span class="s0">None, </span><span class="s1">img_hover=</span><span class="s0">None,</span>
                        <span class="s1">alpha=</span><span class="s5">255</span><span class="s0">, </span><span class="s1">colorkey=</span><span class="s0">None, </span><span class="s1">text=</span><span class="s2">&quot;&quot;</span><span class="s1">):</span>
    <span class="s1">e = Clickable(text</span><span class="s0">,</span><span class="s1">finish=</span><span class="s0">False</span><span class="s1">)</span>
    <span class="s1">painter = ButtonImage(img_normal</span><span class="s0">, </span><span class="s1">img_pressed</span><span class="s0">, </span><span class="s1">img_hover</span><span class="s0">, </span><span class="s1">alpha</span><span class="s0">, </span><span class="s1">colorkey)</span>
    <span class="s1">e.set_painter(painter)</span>
    <span class="s1">e.finish()</span>
    <span class="s0">return </span><span class="s1">e</span>


<span class="s0">def </span><span class="s1">make_text(text</span><span class="s0">, </span><span class="s1">font_size=</span><span class="s0">None, </span><span class="s1">font_color=</span><span class="s0">None</span><span class="s1">):</span>
    <span class="s0">if </span><span class="s1">font_size </span><span class="s0">is None</span><span class="s1">: font_size = style.FONT_SIZE</span>
    <span class="s0">if </span><span class="s1">font_color </span><span class="s0">is None</span><span class="s1">: font_color = style.FONT_COLOR</span>
    <span class="s1">params = {</span><span class="s2">&quot;font_color&quot;</span><span class="s1">:font_color</span><span class="s0">, </span><span class="s2">&quot;font_size&quot;</span><span class="s1">:font_size}</span>
    <span class="s1">button = Element(text</span><span class="s0">, </span><span class="s1">normal_params=params</span><span class="s0">, </span><span class="s1">finish=</span><span class="s0">False</span><span class="s1">)</span>
    <span class="s0">if not </span><span class="s2">&quot;</span><span class="s0">\n</span><span class="s2">&quot; </span><span class="s0">in </span><span class="s1">text:</span>
        <span class="s1">button.set_style(</span><span class="s2">&quot;text&quot;</span><span class="s1">)</span>
    <span class="s1">button.finish()</span>
    <span class="s0">if </span><span class="s2">&quot;</span><span class="s0">\n</span><span class="s2">&quot; </span><span class="s0">in </span><span class="s1">text:</span>
        <span class="s1">button.scale_to_title()</span>
        <span class="s1">button.set_main_color((</span><span class="s5">0</span><span class="s0">,</span><span class="s5">0</span><span class="s0">,</span><span class="s5">0</span><span class="s0">,</span><span class="s5">0</span><span class="s1">))</span>
    <span class="s0">return </span><span class="s1">button</span>

<span class="s0">def </span><span class="s1">make_font_setter(fn</span><span class="s0">, </span><span class="s1">const_text=</span><span class="s2">&quot;&quot;</span><span class="s0">, </span><span class="s1">var_text=</span><span class="s2">&quot;&quot;</span><span class="s0">, </span><span class="s1">ddl_size=</span><span class="s2">&quot;auto&quot;</span><span class="s1">):</span>
    <span class="s0">from </span><span class="s1">thorpy.elements.launchers.dropdownlistlauncher </span><span class="s0">import </span><span class="s1">DropDownListLauncher</span>
    <span class="s0">from </span><span class="s1">thorpy.miscgui.reaction </span><span class="s0">import </span><span class="s1">Reaction</span>
    <span class="s0">from </span><span class="s1">thorpy.miscgui.metadata </span><span class="s0">import </span><span class="s1">MetaDataManager</span>
    <span class="s0">import </span><span class="s1">os</span><span class="s0">, </span><span class="s1">sys</span>
    <span class="s1">titles = list(constants.AVAILABLE_FONTS)</span>
    <span class="s1">titles.sort()</span>
    <span class="s1">button = DropDownListLauncher.make(const_text</span><span class="s0">, </span><span class="s1">var_text</span><span class="s0">,</span>
                                        <span class="s1">titles</span><span class="s0">,</span>
                                        <span class="s1">show_select=</span><span class="s0">False,</span>
                                        <span class="s1">ddlf_size=ddl_size)</span>
    <span class="s0">def </span><span class="s1">reac_func(event):</span>
        <span class="s1">font = event.value</span>
        <span class="s1">mdm = MetaDataManager()</span>
        <span class="s1">mdm.read_data(fn)</span>
        <span class="s1">mdm.data[</span><span class="s2">&quot;font&quot;</span><span class="s1">] = font</span>
        <span class="s1">mdm.write_data(fn)</span>
        <span class="s3">#restart script</span>
        <span class="s1">python = sys.executable</span>
        <span class="s1">os.execl(python</span><span class="s0">, </span><span class="s1">python</span><span class="s0">, </span><span class="s1">* sys.argv)</span>
    <span class="s1">reac = Reaction(constants.THORPY_EVENT</span><span class="s0">, </span><span class="s1">reac_func</span><span class="s0">, </span><span class="s1">{</span><span class="s2">&quot;id&quot;</span><span class="s1">:constants.EVENT_DDL</span><span class="s0">,</span>
                                                        <span class="s2">&quot;el&quot;</span><span class="s1">:button})</span>
    <span class="s1">button.add_reaction(reac)</span>
    <span class="s0">return </span><span class="s1">button</span>

<span class="s0">def </span><span class="s1">make_fontsize_setter(fn</span><span class="s0">, </span><span class="s1">const_text=</span><span class="s2">&quot;&quot;</span><span class="s0">, </span><span class="s1">slider_length=</span><span class="s5">100</span><span class="s0">, </span><span class="s1">limvals=(</span><span class="s5">6</span><span class="s0">,</span><span class="s5">36</span><span class="s1">)):</span>
    <span class="s0">from </span><span class="s1">thorpy.miscgui.reaction </span><span class="s0">import </span><span class="s1">Reaction</span>
    <span class="s0">from </span><span class="s1">thorpy.miscgui.metadata </span><span class="s0">import </span><span class="s1">MetaDataManager</span>
    <span class="s0">from </span><span class="s1">thorpy.elements.launchers.paramsetterlauncher </span><span class="s0">import </span><span class="s1">ParamSetterLauncher</span>
    <span class="s0">from </span><span class="s1">thorpy.miscgui.varset </span><span class="s0">import </span><span class="s1">VarSet</span>
    <span class="s0">import </span><span class="s1">os</span><span class="s0">, </span><span class="s1">sys</span>
    <span class="s1">varset = VarSet()</span>
    <span class="s1">varset.add(</span><span class="s2">&quot;fontsize&quot;</span><span class="s0">, </span><span class="s1">value=style.FONT_SIZE</span><span class="s0">, </span><span class="s1">text=</span><span class="s2">&quot;Font size:&quot;</span><span class="s0">,</span>
                <span class="s1">limits=limvals</span><span class="s0">, </span><span class="s1">more={</span><span class="s2">&quot;length&quot;</span><span class="s1">:slider_length})</span>
    <span class="s1">button = ParamSetterLauncher.make([varset]</span><span class="s0">, </span><span class="s1">const_text</span><span class="s0">, </span><span class="s1">const_text</span><span class="s0">,</span>
                                        <span class="s1">text_ok=</span><span class="s2">&quot;Apply&quot;</span><span class="s1">)</span>
    <span class="s0">def </span><span class="s1">reac_func(event):</span>
        <span class="s0">if </span><span class="s1">event.what == constants.LAUNCH_DONE:</span>
            <span class="s1">font_size = varset.get_value(</span><span class="s2">&quot;fontsize&quot;</span><span class="s1">)</span>
            <span class="s1">mdm = MetaDataManager()</span>
            <span class="s1">mdm.read_data(fn)</span>
            <span class="s1">mdm.data[</span><span class="s2">&quot;font_size&quot;</span><span class="s1">] = font_size</span>
<span class="s3">##            print(&quot;writing&quot;, mdm.data, fn)</span>
            <span class="s1">mdm.write_data(fn)</span>
            <span class="s3">#restart script</span>
            <span class="s1">python = sys.executable</span>
            <span class="s1">os.execl(python</span><span class="s0">, </span><span class="s1">python</span><span class="s0">, </span><span class="s1">* sys.argv)</span>
    <span class="s1">reac = Reaction(constants.THORPY_EVENT</span><span class="s0">, </span><span class="s1">reac_func</span><span class="s0">, </span><span class="s1">{</span><span class="s2">&quot;id&quot;</span><span class="s1">:constants.EVENT_UNLAUNCH</span><span class="s0">,</span>
                                                        <span class="s2">&quot;launcher&quot;</span><span class="s1">:button.launcher})</span>
    <span class="s1">button.add_reaction(reac)</span>
    <span class="s0">return </span><span class="s1">button</span>

<span class="s0">def </span><span class="s1">make_font_options_setter(fn</span><span class="s0">, </span><span class="s1">const_text=</span><span class="s2">&quot;&quot;</span><span class="s0">, </span><span class="s1">var_text=</span><span class="s2">&quot;&quot;</span><span class="s0">, </span><span class="s1">ddl_size=</span><span class="s2">&quot;auto&quot;</span><span class="s0">,</span>
                             <span class="s1">slider_length=</span><span class="s5">100</span><span class="s0">, </span><span class="s1">limvals=(</span><span class="s5">6</span><span class="s0">,</span><span class="s5">36</span><span class="s1">)):</span>
    <span class="s0">from </span><span class="s1">thorpy.miscgui.reaction </span><span class="s0">import </span><span class="s1">Reaction</span>
    <span class="s0">from </span><span class="s1">thorpy.miscgui.metadata </span><span class="s0">import </span><span class="s1">MetaDataManager</span>
    <span class="s0">from </span><span class="s1">thorpy.elements.launchers.paramsetterlauncher </span><span class="s0">import </span><span class="s1">ParamSetterLauncher</span>
    <span class="s0">from </span><span class="s1">thorpy.miscgui.varset </span><span class="s0">import </span><span class="s1">VarSet</span>
    <span class="s0">import </span><span class="s1">os</span><span class="s0">, </span><span class="s1">sys</span>
    <span class="s1">varset = VarSet()</span>
    <span class="s1">titles = list(constants.AVAILABLE_FONTS)</span>
    <span class="s1">titles.sort()</span>
    <span class="s1">current_font = functions.get_default_font_infos()[</span><span class="s2">&quot;name&quot;</span><span class="s1">]</span>
    <span class="s1">varset.add(</span><span class="s2">&quot;fontname&quot;</span><span class="s0">, </span><span class="s1">titles</span><span class="s0">, </span><span class="s1">text=</span><span class="s2">&quot;Font: &quot;</span><span class="s0">, </span><span class="s1">more={</span><span class="s2">&quot;ddlf_size&quot;</span><span class="s1">:ddl_size</span><span class="s0">,</span>
                                                        <span class="s2">&quot;var_text&quot;</span><span class="s1">:current_font})</span>
    <span class="s1">varset.add(</span><span class="s2">&quot;fontsize&quot;</span><span class="s0">, </span><span class="s1">value=style.FONT_SIZE</span><span class="s0">, </span><span class="s1">text=</span><span class="s2">&quot;Font size:&quot;</span><span class="s0">,</span>
                <span class="s1">limits=limvals</span><span class="s0">, </span><span class="s1">more={</span><span class="s2">&quot;length&quot;</span><span class="s1">:slider_length})</span>
    <span class="s1">button = ParamSetterLauncher.make([varset]</span><span class="s0">, </span><span class="s1">const_text</span><span class="s0">, </span><span class="s1">const_text</span><span class="s0">,</span>
                                        <span class="s1">text_ok=</span><span class="s2">&quot;Apply&quot;</span><span class="s1">)</span>
    <span class="s0">def </span><span class="s1">reac_func(event):</span>
        <span class="s0">if </span><span class="s1">event.what == constants.LAUNCH_DONE:</span>
            <span class="s1">font_size = varset.get_value(</span><span class="s2">&quot;fontsize&quot;</span><span class="s1">)</span>
            <span class="s1">font_name = varset.get_value(</span><span class="s2">&quot;fontname&quot;</span><span class="s1">)</span>
<span class="s3">##            print(&quot;font_name=&quot;, font_name)</span>
            <span class="s1">mdm = MetaDataManager()</span>
            <span class="s1">mdm.read_data(fn)</span>
            <span class="s1">mdm.data[</span><span class="s2">&quot;font_size&quot;</span><span class="s1">] = font_size</span>
            <span class="s1">mdm.data[</span><span class="s2">&quot;font&quot;</span><span class="s1">] = font_name</span>
<span class="s3">##            print(&quot;writing&quot;, mdm.data, fn)</span>
            <span class="s1">mdm.write_data(fn)</span>
            <span class="s3">#restart script</span>
            <span class="s1">python = sys.executable</span>
            <span class="s1">os.execl(python</span><span class="s0">, </span><span class="s1">python</span><span class="s0">, </span><span class="s1">* sys.argv)</span>
    <span class="s1">reac = Reaction(constants.THORPY_EVENT</span><span class="s0">, </span><span class="s1">reac_func</span><span class="s0">, </span><span class="s1">{</span><span class="s2">&quot;id&quot;</span><span class="s1">:constants.EVENT_UNLAUNCH</span><span class="s0">,</span>
                                                        <span class="s2">&quot;launcher&quot;</span><span class="s1">:button.launcher})</span>
    <span class="s1">button.add_reaction(reac)</span>
    <span class="s0">return </span><span class="s1">button</span>

<span class="s0">def </span><span class="s1">make_display_options_setter(fn</span><span class="s0">, </span><span class="s1">const_text=</span><span class="s2">&quot;&quot;</span><span class="s0">,</span>
                                <span class="s1">sliders_length=</span><span class="s5">100</span><span class="s0">,</span>
                                <span class="s1">limvalsw=(</span><span class="s5">400</span><span class="s0">,None</span><span class="s1">)</span><span class="s0">,</span>
                                <span class="s1">limvalsh=(</span><span class="s5">400</span><span class="s0">,None</span><span class="s1">)</span><span class="s0">,</span>
                                <span class="s1">restart_app=</span><span class="s0">True</span><span class="s1">):</span>
    <span class="s0">from </span><span class="s1">thorpy.miscgui.reaction </span><span class="s0">import </span><span class="s1">Reaction</span>
    <span class="s0">from </span><span class="s1">thorpy.miscgui.metadata </span><span class="s0">import </span><span class="s1">MetaDataManager</span>
    <span class="s0">from </span><span class="s1">thorpy.elements.launchers.paramsetterlauncher </span><span class="s0">import </span><span class="s1">ParamSetterLauncher</span>
    <span class="s0">from </span><span class="s1">thorpy.miscgui.varset </span><span class="s0">import </span><span class="s1">VarSet</span>
    <span class="s0">import </span><span class="s1">os</span><span class="s0">, </span><span class="s1">sys</span>
    <span class="s1">varset = VarSet()</span>
    <span class="s1">w</span><span class="s0">,</span><span class="s1">h = functions.get_screen_size()</span>
    <span class="s1">maxsize = functions.get_max_screen_size()</span>
    <span class="s0">if </span><span class="s1">limvalsw[</span><span class="s5">1</span><span class="s1">] </span><span class="s0">is None</span><span class="s1">: limvalsw = (limvalsw[</span><span class="s5">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">maxsize[</span><span class="s5">0</span><span class="s1">])</span>
    <span class="s0">if </span><span class="s1">limvalsh[</span><span class="s5">1</span><span class="s1">] </span><span class="s0">is None</span><span class="s1">: limvalsh = (limvalsh[</span><span class="s5">0</span><span class="s1">]</span><span class="s0">, </span><span class="s1">maxsize[</span><span class="s5">1</span><span class="s1">])</span>
    <span class="s1">fullscreen = bool(functions.get_screen().get_flags()&amp;pygame.FULLSCREEN)</span>
    <span class="s1">varset.add(</span><span class="s2">&quot;screen_w&quot;</span><span class="s0">, </span><span class="s1">value=int(w)</span><span class="s0">, </span><span class="s1">text=</span><span class="s2">&quot;Screen width: &quot;</span><span class="s0">, </span><span class="s1">limits=limvalsw)</span>
    <span class="s1">varset.add(</span><span class="s2">&quot;screen_h&quot;</span><span class="s0">, </span><span class="s1">value=int(h)</span><span class="s0">, </span><span class="s1">text=</span><span class="s2">&quot;Screen height: &quot;</span><span class="s0">, </span><span class="s1">limits=limvalsh)</span>
    <span class="s1">varset.add(</span><span class="s2">&quot;fullscreen&quot;</span><span class="s0">, </span><span class="s1">value=fullscreen</span><span class="s0">, </span><span class="s1">text=</span><span class="s2">&quot;Fullscreen&quot;</span><span class="s1">)</span>
    <span class="s1">button = ParamSetterLauncher.make([varset]</span><span class="s0">, </span><span class="s1">const_text</span><span class="s0">, </span><span class="s1">const_text</span><span class="s0">,</span>
                                      <span class="s1">text_ok=</span><span class="s2">&quot;Apply&quot;</span><span class="s1">)</span>
    <span class="s0">def </span><span class="s1">reac_func_norestart(event):</span>
        <span class="s0">if </span><span class="s1">event.what == constants.LAUNCH_DONE:</span>
            <span class="s1">w</span><span class="s0">,</span><span class="s1">h = varset.get_value(</span><span class="s2">&quot;screen_w&quot;</span><span class="s1">)</span><span class="s0">, </span><span class="s1">varset.get_value(</span><span class="s2">&quot;screen_h&quot;</span><span class="s1">)</span>
            <span class="s1">mdm = MetaDataManager()</span>
            <span class="s1">mdm.read_data(fn)</span>
            <span class="s1">mdm.data[</span><span class="s2">&quot;screen_w&quot;</span><span class="s1">] = w</span>
            <span class="s1">mdm.data[</span><span class="s2">&quot;screen_h&quot;</span><span class="s1">] = h</span>
            <span class="s1">mdm.data[</span><span class="s2">&quot;fullscreen&quot;</span><span class="s1">] = varset.get_value(</span><span class="s2">&quot;fullscreen&quot;</span><span class="s1">)</span>
<span class="s3">##            print(&quot;writing&quot;, mdm.data, fn)</span>
            <span class="s1">mdm.write_data(fn)</span>
            <span class="s3">#restart script</span>
            <span class="s1">flags = functions.get_screen().get_flags()</span>
            <span class="s0">if </span><span class="s1">varset.get_value(</span><span class="s2">&quot;fullscreen&quot;</span><span class="s1">):</span>
                <span class="s1">flags |= pygame.FULLSCREEN</span>
            <span class="s0">else</span><span class="s1">:</span>
                <span class="s1">flags = </span><span class="s5">0</span>
            <span class="s1">pygame.display.set_mode((w</span><span class="s0">,</span><span class="s1">h)</span><span class="s0">, </span><span class="s1">flags)</span>
            <span class="s1">functions.get_current_menu()._elements[</span><span class="s5">0</span><span class="s1">].get_oldest_ancester().unblit_and_reblit()</span>
            <span class="s1">button.launched.blit()</span>
            <span class="s1">button.launched.update()</span>

    <span class="s0">def </span><span class="s1">reac_func_restart(event):</span>
        <span class="s0">if </span><span class="s1">event.what == constants.LAUNCH_DONE:</span>
            <span class="s1">w</span><span class="s0">,</span><span class="s1">h = varset.get_value(</span><span class="s2">&quot;screen_w&quot;</span><span class="s1">)</span><span class="s0">, </span><span class="s1">varset.get_value(</span><span class="s2">&quot;screen_h&quot;</span><span class="s1">)</span>
            <span class="s1">mdm = MetaDataManager()</span>
            <span class="s1">mdm.read_data(fn)</span>
            <span class="s1">mdm.data[</span><span class="s2">&quot;screen_w&quot;</span><span class="s1">] = w</span>
            <span class="s1">mdm.data[</span><span class="s2">&quot;screen_h&quot;</span><span class="s1">] = h</span>
            <span class="s1">mdm.data[</span><span class="s2">&quot;fullscreen&quot;</span><span class="s1">] = varset.get_value(</span><span class="s2">&quot;fullscreen&quot;</span><span class="s1">)</span>
<span class="s3">##            print(&quot;writing&quot;, mdm.data, fn)</span>
            <span class="s1">mdm.write_data(fn)</span>
            <span class="s3">#restart script</span>
            <span class="s1">python = sys.executable</span>
            <span class="s1">os.execl(python</span><span class="s0">, </span><span class="s1">python</span><span class="s0">, </span><span class="s1">* sys.argv)</span>

    <span class="s1">reac_func=reac_func_restart </span><span class="s0">if </span><span class="s1">restart_app </span><span class="s0">else </span><span class="s1">reac_func_norestart</span>
    <span class="s1">reac = Reaction(constants.THORPY_EVENT</span><span class="s0">, </span><span class="s1">reac_func</span><span class="s0">, </span><span class="s1">{</span><span class="s2">&quot;id&quot;</span><span class="s1">:constants.EVENT_UNLAUNCH</span><span class="s0">,</span>
                                                        <span class="s2">&quot;launcher&quot;</span><span class="s1">:button.launcher})</span>
    <span class="s1">button.add_reaction(reac)</span>
    <span class="s0">return </span><span class="s1">button</span>

<span class="s0">def </span><span class="s1">make_global_display_options(fn</span><span class="s0">, </span><span class="s1">text):</span>
    <span class="s4">&quot;&quot;&quot;Returns a button to launch font and display options&quot;&quot;&quot;</span>
    <span class="s0">from </span><span class="s1">thorpy.miscgui.launchers.launcher </span><span class="s0">import </span><span class="s1">make_ok_box</span><span class="s0">, </span><span class="s1">make_launcher</span>
    <span class="s1">font_options = make_font_options_setter(fn</span><span class="s0">, </span><span class="s2">&quot;Font options&quot;</span><span class="s1">)</span>
    <span class="s1">disp_options = make_display_options_setter(fn</span><span class="s0">, </span><span class="s2">&quot;Display options&quot;</span><span class="s1">)</span>
    <span class="s1">box = make_ok_box([disp_options</span><span class="s0">, </span><span class="s1">font_options]</span><span class="s0">, </span><span class="s2">&quot;Return&quot;</span><span class="s1">)</span>
    <span class="s0">return </span><span class="s1">make_launcher(box</span><span class="s0">, </span><span class="s1">text)</span>
<span class="s3">##    return box</span>

<span class="s0">def </span><span class="s1">make_menu_button(frame_size=(</span><span class="s5">40</span><span class="s0">,</span><span class="s5">40</span><span class="s1">)</span><span class="s0">, </span><span class="s1">lines_size=(</span><span class="s5">25</span><span class="s0">,</span><span class="s5">2</span><span class="s1">)</span><span class="s0">, </span><span class="s1">lines_radius=</span><span class="s5">1</span><span class="s0">,</span>
                     <span class="s1">lines_color=(</span><span class="s5">0</span><span class="s0">,</span><span class="s5">0</span><span class="s0">,</span><span class="s5">0</span><span class="s1">)</span><span class="s0">, </span><span class="s1">n=</span><span class="s5">3</span><span class="s1">):</span>
    <span class="s1">e = make_button(</span><span class="s2">&quot;&quot;</span><span class="s1">)</span>
    <span class="s1">e.set_size(frame_size)</span>
    <span class="s1">imgs = {}</span>
    <span class="s0">for </span><span class="s1">state </span><span class="s0">in </span><span class="s1">e.get_states():</span>
        <span class="s1">img = e.get_image(state)</span>
        <span class="s1">frame = img.get_rect()</span>
        <span class="s1">line = graphics.get_aa_round_rect(lines_size</span><span class="s0">, </span><span class="s1">lines_radius</span><span class="s0">, </span><span class="s1">lines_color)</span>
        <span class="s1">rect = line.get_rect()</span>
        <span class="s1">rect.centerx = frame.centerx</span>
        <span class="s1">margin = frame.h//</span><span class="s5">3</span>
        <span class="s1">gap = (frame.h - </span><span class="s5">2</span><span class="s1">*margin - n*rect.h) // (n-</span><span class="s5">1</span><span class="s1">)</span>
        <span class="s0">for </span><span class="s1">y </span><span class="s0">in </span><span class="s1">range(n):</span>
            <span class="s1">rect.y = margin + y*(gap+rect.h)</span>
            <span class="s1">img.blit(line</span><span class="s0">, </span><span class="s1">rect.topleft)</span>
        <span class="s1">imgs[state] = img</span>
    <span class="s1">e = make_image_button(imgs[constants.STATE_NORMAL]</span><span class="s0">,</span>
                            <span class="s1">imgs[constants.STATE_PRESSED]</span><span class="s0">,</span>
                            <span class="s1">imgs[constants.STATE_NORMAL])</span>
    <span class="s0">return </span><span class="s1">e</span>


<span class="s0">class </span><span class="s1">SliderInserter:</span>

    <span class="s0">def </span><span class="s1">__init__(self</span><span class="s0">, </span><span class="s1">text</span><span class="s0">, </span><span class="s1">length</span><span class="s0">, </span><span class="s1">limvals</span><span class="s0">, </span><span class="s1">initial_value</span><span class="s0">,</span>
                    <span class="s1">reblit=</span><span class="s0">None, </span><span class="s1">type_=float</span><span class="s0">, </span><span class="s1">order=</span><span class="s2">&quot;ins&quot;</span><span class="s1">):</span>
        <span class="s0">import </span><span class="s1">thorpy</span>
        <span class="s1">self.text = thorpy.make_button(text</span><span class="s0">, </span><span class="s1">self.focus)</span>
        <span class="s1">self.slider = thorpy.SliderX.make(length</span><span class="s0">, </span><span class="s1">limvals</span><span class="s0">, </span><span class="s2">&quot;&quot;</span><span class="s0">, </span><span class="s1">type_</span><span class="s0">, </span><span class="s1">initial_value)</span>
        <span class="s1">self.ins = thorpy.Inserter.make(</span><span class="s2">&quot;&quot;</span><span class="s0">, </span><span class="s1">value=str(initial_value))</span>
        <span class="s0">if </span><span class="s1">order == </span><span class="s2">&quot;ins&quot;</span><span class="s1">:</span>
            <span class="s1">els = [self.text</span><span class="s0">, </span><span class="s1">self.ins</span><span class="s0">, </span><span class="s1">self.slider]</span>
        <span class="s0">else</span><span class="s1">:</span>
            <span class="s1">els = [self.text</span><span class="s0">, </span><span class="s1">self.slider</span><span class="s0">, </span><span class="s1">self.ins]</span>
        <span class="s1">self.e = thorpy.make_group(els)</span>
        <span class="s1">reac_slide = thorpy.Reaction(reacts_to=thorpy.constants.THORPY_EVENT</span><span class="s0">,</span>
                                <span class="s1">reac_func=self.at_slide</span><span class="s0">,</span>
                                <span class="s1">event_args={</span><span class="s2">&quot;id&quot;</span><span class="s1">:thorpy.constants.EVENT_SLIDE})</span>
        <span class="s1">reac_ins = thorpy.Reaction(reacts_to=thorpy.constants.THORPY_EVENT</span><span class="s0">,</span>
                                        <span class="s1">reac_func=self.at_insert</span><span class="s0">,</span>
                                        <span class="s1">event_args={</span><span class="s2">&quot;id&quot;</span><span class="s1">:thorpy.constants.EVENT_INSERT})</span>
        <span class="s1">self.e.add_reactions([reac_slide</span><span class="s0">, </span><span class="s1">reac_ins])</span>
        <span class="s1">self.e._manager = self</span>
        <span class="s1">self.ins._manager = self</span>
        <span class="s1">self.slider._manager = self</span>
        <span class="s1">self.e.get_value = self.slider.get_value</span>
        <span class="s1">self.reblit = reblit</span>
        <span class="s0">if not </span><span class="s1">self.reblit:</span>
            <span class="s1">self.reblit = self.e.unblit_and_reblit</span>

    <span class="s0">def </span><span class="s1">ins2slide(self):</span>
        <span class="s1">val = self.slider._value_type(self.ins.get_value())</span>
        <span class="s0">if </span><span class="s1">val &gt; self.slider.limvals[</span><span class="s5">1</span><span class="s1">]:</span>
            <span class="s1">val = self.slider.limvals[</span><span class="s5">1</span><span class="s1">]</span>
            <span class="s1">self.ins.set_value(str(val))</span>
        <span class="s0">elif </span><span class="s1">val &lt; self.slider.limvals[</span><span class="s5">0</span><span class="s1">]:</span>
            <span class="s1">val = self.slider.limvals[</span><span class="s5">1</span><span class="s1">]</span>
            <span class="s1">self.ins.set_value(str(val))</span>
        <span class="s1">self.slider.set_value(val)</span>

    <span class="s0">def </span><span class="s1">slide2ins(self):</span>
        <span class="s1">self.ins.set_value(str(self.slider.get_value()))</span>

    <span class="s0">def </span><span class="s1">at_slide(self</span><span class="s0">, </span><span class="s1">event):</span>
        <span class="s0">if </span><span class="s1">event.el._manager </span><span class="s0">is </span><span class="s1">self:</span>
            <span class="s1">self.slide2ins()</span>
            <span class="s1">self.reblit()</span>

    <span class="s0">def </span><span class="s1">at_insert(self</span><span class="s0">, </span><span class="s1">event):</span>
        <span class="s0">if </span><span class="s1">event.el._manager </span><span class="s0">is </span><span class="s1">self:</span>
            <span class="s1">self.ins2slide()</span>
            <span class="s1">self.reblit()</span>

    <span class="s0">def </span><span class="s1">focus(self):</span>
        <span class="s1">self.ins.enter()</span>


<span class="s0">def </span><span class="s1">make_slider_inserter(text</span><span class="s0">, </span><span class="s1">length</span><span class="s0">, </span><span class="s1">limvals</span><span class="s0">, </span><span class="s1">initial_value</span><span class="s0">, </span><span class="s1">reblit=</span><span class="s0">None, </span><span class="s1">type_=float</span><span class="s0">,</span>
                            <span class="s1">order=</span><span class="s2">&quot;ins&quot;</span><span class="s1">):</span>
    <span class="s0">return </span><span class="s1">SliderInserter(text</span><span class="s0">, </span><span class="s1">length</span><span class="s0">, </span><span class="s1">limvals</span><span class="s0">, </span><span class="s1">initial_value</span><span class="s0">, </span><span class="s1">reblit</span><span class="s0">, </span><span class="s1">type_</span><span class="s0">, </span><span class="s1">order).e</span>



<span class="s0">def </span><span class="s1">get_user_text(title</span><span class="s0">, </span><span class="s1">value</span><span class="s0">, </span><span class="s1">size=(</span><span class="s0">None,None</span><span class="s1">)):</span>
    <span class="s0">from </span><span class="s1">thorpy.miscgui.launchers.launcher </span><span class="s0">import </span><span class="s1">make_ok_box</span><span class="s0">, </span><span class="s1">auto_ok</span><span class="s0">, </span><span class="s1">launch_blocking</span>
    <span class="s1">ins = Inserter.make(title</span><span class="s0">,</span><span class="s1">value=value</span><span class="s0">,</span><span class="s1">size=size)</span>
    <span class="s1">box = make_ok_box([ins])</span>
    <span class="s1">auto_ok(box)</span>
    <span class="s1">box.center()</span>
    <span class="s1">ins.enter()</span>
    <span class="s1">launch_blocking(box)</span>
    <span class="s0">return </span><span class="s1">ins.get_value()</span>


<span class="s0">def </span><span class="s1">bicolor_text(text</span><span class="s0">, </span><span class="s1">font_size</span><span class="s0">, </span><span class="s1">color1</span><span class="s0">, </span><span class="s1">color2</span><span class="s0">, </span><span class="s1">space=</span><span class="s5">0</span><span class="s1">):</span>
    <span class="s0">import </span><span class="s1">thorpy</span>
    <span class="s1">get_shadow = thorpy.graphics.get_shadow</span>
    <span class="s1">writer = Writer(size=font_size)</span>
    <span class="s1">width = writer.get_width(text) + (len(text)-</span><span class="s5">1</span><span class="s1">)*space</span>
    <span class="s1">height = writer.get_height()</span>
    <span class="s1">surface = pygame.Surface((width</span><span class="s0">, </span><span class="s1">height))</span>
    <span class="s1">alpha_color = (</span><span class="s5">50</span><span class="s0">,</span><span class="s5">100</span><span class="s0">,</span><span class="s5">150</span><span class="s1">)</span>
    <span class="s1">surface.fill(alpha_color)</span>
    <span class="s1">surface.set_colorkey(alpha_color)</span>
    <span class="s1">x = </span><span class="s5">0</span>
    <span class="s0">for </span><span class="s1">letter </span><span class="s0">in </span><span class="s1">text:</span>
        <span class="s1">img = make_text(letter</span><span class="s0">, </span><span class="s1">font_size-</span><span class="s5">20</span><span class="s0">, </span><span class="s1">color1).get_image()</span>
        <span class="s1">shad = get_shadow(img</span><span class="s0">, </span><span class="s1">shadow_radius=</span><span class="s5">0</span><span class="s0">, </span><span class="s1">black=</span><span class="s5">255</span><span class="s0">,</span>
                            <span class="s1">color_format=</span><span class="s2">&quot;RGBA&quot;</span><span class="s0">, </span><span class="s1">alpha_factor=</span><span class="s5">1.</span><span class="s0">,</span>
                            <span class="s1">decay_mode=</span><span class="s2">&quot;exponential&quot;</span><span class="s0">, </span><span class="s1">color=color2</span><span class="s0">,</span>
                            <span class="s1">sun_angle=</span><span class="s5">45.</span><span class="s0">, </span><span class="s1">vertical=</span><span class="s0">True, </span><span class="s1">angle_mode=</span><span class="s2">&quot;flip&quot;</span><span class="s0">,</span>
                            <span class="s1">mode_value=(</span><span class="s0">False, False</span><span class="s1">))</span>
        <span class="s1">size = shad.get_rect().inflate(</span><span class="s5">6</span><span class="s0">,</span><span class="s5">6</span><span class="s1">).size</span>
        <span class="s1">shad = pygame.transform.smoothscale(shad</span><span class="s0">, </span><span class="s1">size)</span>
        <span class="s1">img1 = shad</span>
        <span class="s1">img2 = img</span>
        <span class="s1">r1 = img1.get_rect()</span>
        <span class="s1">r1.left = x</span>
        <span class="s1">r2 = img2.get_rect()</span>
        <span class="s1">r2.center = r1.center</span>
        <span class="s1">surface.blit(img1</span><span class="s0">, </span><span class="s1">r1)</span>
        <span class="s1">surface.blit(img2</span><span class="s0">, </span><span class="s1">r2)</span>
        <span class="s1">x += img1.get_width() + space</span>
    <span class="s0">return </span><span class="s1">surface</span></pre>
</body>
</html>