<html>
<head>
<title>inserter.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #629755; font-style: italic;}
.s1 { color: #a9b7c6;}
.s2 { color: #808080;}
.s3 { color: #cc7832;}
.s4 { color: #6a8759;}
.s5 { color: #6897bb;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
inserter.py</font>
</center></td></tr></table>
<pre><span class="s0">&quot;&quot;&quot;Inserter&quot;&quot;&quot;</span>
<span class="s2"># ! to forbid other element to react during insert, they should not be in</span>
<span class="s2"># the same menu as the inserter, and maybe use _hide_mouse = True</span>

<span class="s3">from </span><span class="s1">pygame </span><span class="s3">import </span><span class="s1">event</span><span class="s3">, </span><span class="s1">K_ESCAPE</span><span class="s3">, </span><span class="s1">K_RETURN</span><span class="s3">, </span><span class="s1">K_BACKSPACE</span><span class="s3">, </span><span class="s1">KEYDOWN</span><span class="s3">, </span><span class="s1">K_LEFT</span><span class="s3">, </span><span class="s1">K_RIGHT</span>
<span class="s3">from </span><span class="s1">pygame.mouse </span><span class="s3">import </span><span class="s1">set_visible </span><span class="s3">as </span><span class="s1">mouse_set_visible</span>
<span class="s3">from </span><span class="s1">pygame.key </span><span class="s3">import </span><span class="s1">set_repeat </span><span class="s3">as </span><span class="s1">key_set_repeat</span>

<span class="s3">from </span><span class="s1">thorpy.elements.clickable </span><span class="s3">import </span><span class="s1">Clickable</span>
<span class="s3">from </span><span class="s1">thorpy.elements._inserterutils._insertwriter </span><span class="s3">import </span><span class="s1">_InsertWriter</span>
<span class="s3">from </span><span class="s1">thorpy.elements._inserterutils._cursor </span><span class="s3">import </span><span class="s1">_Cursor</span>
<span class="s3">from </span><span class="s1">thorpy.painting.mousecursor </span><span class="s3">import </span><span class="s1">change_cursor</span>
<span class="s3">from </span><span class="s1">thorpy.miscgui.reaction </span><span class="s3">import </span><span class="s1">Reaction</span>
<span class="s3">from </span><span class="s1">thorpy.miscgui.keyer </span><span class="s3">import </span><span class="s1">Keyer</span>
<span class="s3">from </span><span class="s1">thorpy.miscgui </span><span class="s3">import </span><span class="s1">constants</span><span class="s3">, </span><span class="s1">functions</span><span class="s3">, </span><span class="s1">parameters</span><span class="s3">, </span><span class="s1">style</span><span class="s3">, </span><span class="s1">painterstyle</span>

<span class="s3">class </span><span class="s1">Inserter(Clickable):</span>
    <span class="s0">&quot;&quot;&quot;Element fo text insertion.&quot;&quot;&quot;</span>

    <span class="s1">@staticmethod</span>
    <span class="s3">def </span><span class="s1">make(name=</span><span class="s4">&quot;&quot;</span><span class="s3">, </span><span class="s1">elements=</span><span class="s3">None, </span><span class="s1">value=</span><span class="s4">&quot;&quot;</span><span class="s3">, </span><span class="s1">size=(</span><span class="s3">None,None</span><span class="s1">)):</span>
        <span class="s1">i = Inserter(name</span><span class="s3">, </span><span class="s1">elements</span><span class="s3">, </span><span class="s1">value=value</span><span class="s3">, </span><span class="s1">size=size</span><span class="s3">,</span><span class="s1">finish=</span><span class="s3">False</span><span class="s1">)</span>
        <span class="s1">i.finish()</span>
        <span class="s3">return </span><span class="s1">i</span>

    <span class="s3">def </span><span class="s1">__init__(self</span><span class="s3">,</span>
                 <span class="s1">name=</span><span class="s4">&quot;&quot;</span><span class="s3">,</span>
                 <span class="s1">elements=</span><span class="s3">None,</span>
                 <span class="s1">normal_params=</span><span class="s3">None,</span>
                 <span class="s1">press_params=</span><span class="s3">None,</span>
                 <span class="s1">value=</span><span class="s4">&quot;&quot;</span><span class="s3">,</span>
                 <span class="s1">size=(</span><span class="s3">None, None</span><span class="s1">)</span><span class="s3">,</span>
                 <span class="s1">namestyle=</span><span class="s3">None,</span>
                 <span class="s1">varlink_func=</span><span class="s3">None,</span>
                 <span class="s1">quit_on_click=</span><span class="s3">False,</span>
                 <span class="s1">value_type=str</span><span class="s3">,</span>
                 <span class="s1">finish=</span><span class="s3">True</span><span class="s1">):</span>
        <span class="s0">&quot;&quot;&quot;Element fo text insertion. 
        &lt;name&gt;: text of the title before the inserter. 
        &lt;value&gt;: initial text inside the inserter. 
        &lt;size&gt;: if not (None,None), a 2-tuple specifying the size of the text 
            insertion zone. 
        &lt;quit_on_click&gt;: if True, make the inserter lose focus when mouse click 
            outside its area. 
        &quot;&quot;&quot;</span>
        <span class="s1">namestyle=style.STYLE_INSERTER_NAME </span><span class="s3">if </span><span class="s1">namestyle </span><span class="s3">is None else </span><span class="s1">namestyle</span>
        <span class="s3">if </span><span class="s1">size[</span><span class="s5">0</span><span class="s1">] </span><span class="s3">is None</span><span class="s1">:</span>
            <span class="s1">s0 = style.SIZE[</span><span class="s5">0</span><span class="s1">]</span>
        <span class="s3">else</span><span class="s1">:</span>
            <span class="s1">s0 = size[</span><span class="s5">0</span><span class="s1">]</span>
        <span class="s3">if </span><span class="s1">size[</span><span class="s5">1</span><span class="s1">] </span><span class="s3">is None</span><span class="s1">:</span>
            <span class="s1">s1 = style.Y_SMALL_SIZE</span>
        <span class="s3">else</span><span class="s1">:</span>
            <span class="s1">s1 = size[</span><span class="s5">1</span><span class="s1">]</span>
        <span class="s1">size = (s0</span><span class="s3">, </span><span class="s1">s1)</span>
        <span class="s1">self.cursor = </span><span class="s3">None</span>
        <span class="s1">super(Inserter</span><span class="s3">, </span><span class="s1">self).__init__(</span><span class="s4">&quot;&quot;</span><span class="s3">, </span><span class="s1">elements</span><span class="s3">, </span><span class="s1">normal_params</span><span class="s3">,</span>
                                       <span class="s1">press_params</span><span class="s3">,</span><span class="s1">finish=</span><span class="s3">False</span><span class="s1">)</span>
        <span class="s1">self._name_element = self._get_name_element(name</span><span class="s3">, </span><span class="s1">namestyle)</span>
        <span class="s1">self.add_elements([self._name_element])</span>
        <span class="s1">self._iwriter = _InsertWriter(value)</span>
        <span class="s1">self.add_elements([self._iwriter])</span>
        <span class="s1">self.quit_on_click = quit_on_click</span>
        <span class="s1">self._value_type = value_type</span>
        <span class="s1">painter = functions.obtain_valid_painter(painterstyle.INSERTER_PAINTER</span><span class="s3">,</span>
                                                 <span class="s1">color=style.DEF_COLOR2</span><span class="s3">,</span>
                                                 <span class="s1">pressed=</span><span class="s3">True,</span>
                                                 <span class="s1">size=(s0</span><span class="s3">,</span><span class="s1">s1))</span>
        <span class="s1">self.set_painter(painter)</span>
        <span class="s1">self.normal_params.polite_set(</span><span class="s4">&quot;states hover&quot;</span><span class="s3">,</span>
                                      <span class="s1">[constants.STATE_NORMAL</span><span class="s3">,</span>
                                       <span class="s1">constants.STATE_PRESSED])</span>
        <span class="s1">self.press_params.polite_set(</span><span class="s4">&quot;states hover&quot;</span><span class="s3">,</span>
                                     <span class="s1">[constants.STATE_NORMAL</span><span class="s3">,</span>
                                      <span class="s1">constants.STATE_PRESSED])</span>
        <span class="s1">self._activated = </span><span class="s3">False</span>
        <span class="s1">self._value = value</span>
        <span class="s1">self._inserted = self._value</span>
        <span class="s1">self._cursor_index = len(self._inserted)</span>
        <span class="s1">reac_keypress = Reaction(KEYDOWN</span><span class="s3">, </span><span class="s1">self._reaction_keydown</span><span class="s3">,</span>
                                 <span class="s1">reac_name=constants.REAC_KEYPRESS)</span>
        <span class="s1">self.add_reaction(reac_keypress)</span>
        <span class="s1">self._keyer = Keyer()</span>
        <span class="s1">self._hide_mouse = self.normal_params.params.get(</span><span class="s4">&quot;hide mouse&quot;</span><span class="s3">, False</span><span class="s1">)</span>
        <span class="s1">self._varlink_func = varlink_func</span>
        <span class="s1">self.repeat_delay = parameters.KEY_DELAY</span>
        <span class="s1">self.repeat_interval = parameters.KEY_INTERVAL</span>
        <span class="s1">self.deactivate_on_focus = []</span>
        <span class="s1">self.auto_resize = </span><span class="s3">True</span>
        <span class="s1">self.numeric_only = </span><span class="s3">False</span>
        <span class="s1">self.int_only = </span><span class="s3">False</span>
        <span class="s3">if </span><span class="s1">finish:</span>
            <span class="s1">self.finish()</span>

    <span class="s3">def </span><span class="s1">set_key_repeat(delay</span><span class="s3">, </span><span class="s1">interval):</span>
        <span class="s0">&quot;&quot;&quot;Set delay to None for no repeat.&quot;&quot;&quot;</span>
        <span class="s1">self.repeat_delay = delay</span>
        <span class="s1">self.repeat_interval = interval</span>

    <span class="s3">def </span><span class="s1">make_small_enough(self</span><span class="s3">, </span><span class="s1">word):</span>
        <span class="s3">while not </span><span class="s1">self._iwriter._is_small_enough(word) </span><span class="s3">and </span><span class="s1">word:</span>
            <span class="s1">word = word[:-</span><span class="s5">1</span><span class="s1">]</span>

    <span class="s3">def </span><span class="s1">finish(self):</span>
        <span class="s1">Clickable.finish(self)</span>
        <span class="s2"># cursor is initialized in finish because _iwriter needs self.fusionner</span>
        <span class="s2">#   to initialize...</span>
        <span class="s1">self.make_small_enough(self._inserted)</span>
        <span class="s3">if not </span><span class="s1">self._iwriter._is_small_enough(self._inserted):</span>
            <span class="s1">functions.debug_msg(</span><span class="s4">&quot;Inserter is too small for value&quot;</span><span class="s3">, </span><span class="s1">self._inserted)</span>
            <span class="s3">if </span><span class="s1">self.auto_resize:</span>
                <span class="s1">self.set_size(self._iwriter.get_rect().inflate((</span><span class="s5">2</span><span class="s3">,</span><span class="s5">2</span><span class="s1">)).size)</span>
        <span class="s1">self._iwriter.refresh_img()</span>
        <span class="s1">self.cursor = _Cursor(self)</span>
        <span class="s1">self.add_elements(list([self.cursor]))</span>
        <span class="s1">self._refresh_pos()</span>
        <span class="s1">self.cursor.finish()</span>
        <span class="s1">self._name_element.user_func = self.enter</span>

    <span class="s3">def </span><span class="s1">scale_to_title(self</span><span class="s3">, </span><span class="s1">**kwargs):</span>
        <span class="s3">pass</span>

    <span class="s3">def </span><span class="s1">fit_children(self</span><span class="s3">, </span><span class="s1">**kwargs):</span>
        <span class="s3">pass</span>

    <span class="s3">def </span><span class="s1">_get_name_element(self</span><span class="s3">, </span><span class="s1">name</span><span class="s3">, </span><span class="s1">namestyle):</span>
        <span class="s1">painter = functions.obtain_valid_painter(</span>
            <span class="s1">painterstyle.INSERTER_NAME_PAINTER</span><span class="s3">,</span>
            <span class="s1">size=style.SIZE)</span>
        <span class="s1">el = Clickable(name</span><span class="s3">,</span><span class="s1">finish=</span><span class="s3">False</span><span class="s1">)</span>
        <span class="s1">el.set_painter(painter)</span>
        <span class="s3">if </span><span class="s1">namestyle:</span>
            <span class="s1">el.set_style(namestyle)</span>
        <span class="s1">el.finish()</span>
        <span class="s3">return </span><span class="s1">el</span>

    <span class="s3">def </span><span class="s1">unblit(self</span><span class="s3">, </span><span class="s1">rect=</span><span class="s3">None</span><span class="s1">):</span>
        <span class="s1">self._name_element.unblit(rect)</span>
        <span class="s1">Clickable.unblit(self</span><span class="s3">, </span><span class="s1">rect)</span>

    <span class="s3">def </span><span class="s1">_hover(self):</span>
        <span class="s1">Clickable._hover(self)</span>
        <span class="s1">change_cursor(constants.CURSOR_TEXT)</span>

    <span class="s3">def </span><span class="s1">_unhover(self):</span>
        <span class="s3">if not </span><span class="s1">self._activated:</span>
            <span class="s1">Clickable._unhover(self)</span>
        <span class="s1">change_cursor(constants.CURSOR_NORMAL)</span>

    <span class="s3">def </span><span class="s1">transp_blit(self):</span>
        <span class="s1">a = self.get_oldest_children_ancester()</span>
        <span class="s1">r = self.get_storer_rect()</span>
        <span class="s1">a.unblit(r)</span>
        <span class="s1">a.partial_blit(</span><span class="s3">None, </span><span class="s1">r)</span>

    <span class="s3">def </span><span class="s1">K_RETURN_pressed(self):</span>
        <span class="s3">if </span><span class="s1">self._activated:</span>
            <span class="s1">self._value = self._inserted</span>
            <span class="s1">self.exit()</span>
            <span class="s1">functions.debug_msg(</span><span class="s4">&quot;'&quot; </span><span class="s1">+ self._inserted + </span><span class="s4">&quot;'&quot;</span><span class="s3">, </span><span class="s4">&quot; inserted&quot;</span><span class="s1">)</span>

    <span class="s3">def </span><span class="s1">_reaction_keydown(self</span><span class="s3">, </span><span class="s1">pygame_event):</span>
        <span class="s3">if </span><span class="s1">self._activated:</span>
            <span class="s3">if </span><span class="s1">pygame_event.type == KEYDOWN:</span>
                <span class="s3">if </span><span class="s1">pygame_event.key == K_ESCAPE:</span>
                    <span class="s1">self.exit()</span>
                <span class="s3">elif </span><span class="s1">pygame_event.key == K_RETURN:  </span><span class="s2"># way to exit saving insertion</span>
                    <span class="s1">self.K_RETURN_pressed()</span>
                <span class="s3">elif </span><span class="s1">pygame_event.key == K_BACKSPACE:</span>
                    <span class="s3">if </span><span class="s1">self._cursor_index &gt; </span><span class="s5">0</span><span class="s1">:</span>
                        <span class="s1">before = self._inserted[</span><span class="s5">0</span><span class="s1">:self._cursor_index-</span><span class="s5">1</span><span class="s1">]</span>
                        <span class="s1">after = self._inserted[self._cursor_index:]</span>
                        <span class="s1">self._inserted = before + after</span>
                        <span class="s1">self._cursor_index -= </span><span class="s5">1</span>
                        <span class="s1">self._urbu()</span>
                <span class="s2"># if this is a modifier, the next char will be handled by the</span>
                <span class="s2"># keyer...</span>
                <span class="s3">elif </span><span class="s1">pygame_event.key == K_LEFT:</span>
                    <span class="s3">if </span><span class="s1">self._cursor_index &gt; </span><span class="s5">1</span><span class="s1">:</span>
                        <span class="s1">self._cursor_index -= </span><span class="s5">1</span>
                        <span class="s1">self._urbu()</span>
                <span class="s3">elif </span><span class="s1">pygame_event.key == K_RIGHT:</span>
                    <span class="s3">if </span><span class="s1">self._cursor_index &lt; len(self._inserted):</span>
                        <span class="s1">self._cursor_index += </span><span class="s5">1</span>
                        <span class="s1">self._urbu()</span>
                <span class="s3">elif not </span><span class="s1">pygame_event.key </span><span class="s3">in </span><span class="s1">self._keyer.modifiers:</span>
                    <span class="s1">char = self._keyer.get_char_from_key(pygame_event.key)</span>
                    <span class="s3">if </span><span class="s1">self.numeric_only:</span>
                        <span class="s3">if </span><span class="s1">self.int_only </span><span class="s3">and not </span><span class="s1">char.isnumeric():</span>
                            <span class="s3">return</span>
                        <span class="s3">elif not</span><span class="s1">(char.isnumeric()) </span><span class="s3">and </span><span class="s1">char != </span><span class="s4">&quot;.&quot;</span><span class="s1">:</span>
                            <span class="s3">return</span>
                    <span class="s1">before = self._inserted[</span><span class="s5">0</span><span class="s1">:self._cursor_index]</span>
                    <span class="s1">after = self._inserted[self._cursor_index:]</span>
                    <span class="s1">new_word = before + char + after</span>
                    <span class="s3">if </span><span class="s1">self._iwriter._is_small_enough(new_word):</span>
                        <span class="s1">self._inserted = new_word</span>
                        <span class="s1">self._cursor_index += </span><span class="s5">1</span>
                        <span class="s1">self._urbu()</span>

    <span class="s3">def </span><span class="s1">_urbu(self</span><span class="s3">, </span><span class="s1">graphical=</span><span class="s3">True</span><span class="s1">):</span>
        <span class="s0">&quot;&quot;&quot;Unblit, Refresh cursor pos, Blit, Update. 
        Returns True if the text img has been refreshed. 
        &quot;&quot;&quot;</span>
<span class="s2">##        a = self.get_oldest_children_ancester()</span>
<span class="s2">##        r = self.get_storer_rect()</span>
<span class="s2">##        a.unblit(r)</span>
        <span class="s3">if </span><span class="s1">graphical:</span>
            <span class="s1">self.unblit()</span>
        <span class="s1">txt_refreshed = self._refresh_cursor_pos()  </span><span class="s2"># refreshes iwriter's img!</span>
<span class="s2">##        a.partial_blit(None, r)</span>
        <span class="s3">if </span><span class="s1">graphical:</span>
            <span class="s1">self.blit()</span>
            <span class="s1">self.update()</span>
        <span class="s3">return </span><span class="s1">txt_refreshed</span>

    <span class="s3">def </span><span class="s1">_reaction_press(self</span><span class="s3">, </span><span class="s1">pygame_event):</span>
        <span class="s1">Clickable._reaction_press(self</span><span class="s3">, </span><span class="s1">pygame_event)</span>
        <span class="s3">if </span><span class="s1">self.current_state_key == constants.STATE_PRESSED:</span>
            <span class="s1">self.enter()</span>
        <span class="s3">elif </span><span class="s1">self._activated:</span>
            <span class="s3">if not </span><span class="s1">self.quit_on_click:</span>
                <span class="s1">self._value = self._inserted</span>
            <span class="s1">self.exit()</span>

    <span class="s3">def </span><span class="s1">enter(self):</span>
        <span class="s3">for </span><span class="s1">e </span><span class="s3">in </span><span class="s1">self.deactivate_on_focus:</span>
            <span class="s1">e.active = </span><span class="s3">False</span>
        <span class="s1">functions.debug_msg(</span><span class="s4">&quot;Entering inserter &quot;</span><span class="s3">, </span><span class="s1">self)</span>
        <span class="s3">if </span><span class="s1">self.repeat_delay </span><span class="s3">is not None</span><span class="s1">:</span>
            <span class="s1">key_set_repeat(self.repeat_delay</span><span class="s3">, </span><span class="s1">self.repeat_interval)</span>
        <span class="s3">if </span><span class="s1">self._hide_mouse:</span>
            <span class="s1">mouse_set_visible(</span><span class="s3">False</span><span class="s1">)</span>
        <span class="s1">self._activated = </span><span class="s3">True</span>
        <span class="s1">self.cursor._activated = </span><span class="s3">True</span>

    <span class="s3">def </span><span class="s1">focus(self): </span><span class="s2">#alias for enter</span>
        <span class="s1">self.enter()</span>

    <span class="s3">def </span><span class="s1">exit(self):</span>
        <span class="s1">key_set_repeat(parameters.KEY_DELAY</span><span class="s3">, </span><span class="s1">parameters.KEY_INTERVAL)</span>
        <span class="s3">if </span><span class="s1">self._activated:</span>
            <span class="s1">functions.debug_msg(</span><span class="s4">&quot;Leaving inserter &quot;</span><span class="s3">, </span><span class="s1">self)</span>
            <span class="s1">self._inserted = self._value</span>
            <span class="s1">self._urbu()</span>
            <span class="s1">mouse_set_visible(</span><span class="s3">True</span><span class="s1">)</span>
            <span class="s1">self.cursor.exit()</span>
            <span class="s1">self._activated = </span><span class="s3">False</span>
            <span class="s1">event_quit = event.Event(constants.THORPY_EVENT</span><span class="s3">,</span>
                                   <span class="s1">id=constants.EVENT_INSERT</span><span class="s3">,</span>
                                   <span class="s1">el=self</span><span class="s3">,</span>
                                   <span class="s1">value=self._value)</span>
            <span class="s1">event.post(event_quit)</span>
            <span class="s1">change_cursor(constants.CURSOR_NORMAL)</span>
            <span class="s3">if </span><span class="s1">self._varlink_func:</span>
                <span class="s1">self._varlink_func(self._value)</span>

        <span class="s3">for </span><span class="s1">e </span><span class="s3">in </span><span class="s1">self.deactivate_on_focus:</span>
            <span class="s1">e.active = </span><span class="s3">True</span>

    <span class="s3">def </span><span class="s1">_refresh_cursor_pos(self):</span>
        <span class="s0">&quot;&quot;&quot;Refresh position of the cursor. Used when inserted text changes. 
        Also refreshes iwriter's image! Is used through self._urbu(). 
        Returns True if the text img has been refreshed. 
        &quot;&quot;&quot;</span>
        <span class="s1">txt_refreshed = </span><span class="s3">True</span>
        <span class="s3">if </span><span class="s1">self._iwriter.refresh_img() == -</span><span class="s5">1</span><span class="s1">:  </span><span class="s2"># text too large</span>
            <span class="s1">txt_refreshed = </span><span class="s3">False</span>
            <span class="s1">self._inserted = self._inserted[:-</span><span class="s5">1</span><span class="s1">]</span>
        <span class="s1">pos = self._iwriter._get_cursor_pos()</span>
        <span class="s1">self.cursor.set_topleft(pos)</span>
        <span class="s3">return </span><span class="s1">txt_refreshed</span>

    <span class="s3">def </span><span class="s1">_refresh_pos(self):</span>
        <span class="s0">&quot;&quot;&quot;Refresh position of the whole element.&quot;&quot;&quot;</span>
        <span class="s1">self._iwriter._refresh_pos()</span>
        <span class="s1">l = self.get_fus_topleft()[</span><span class="s5">0</span><span class="s1">]</span>
        <span class="s1">(x</span><span class="s3">, </span><span class="s1">y) = self.get_fus_center()</span>
        <span class="s1">l -= self._name_element.get_fus_size()[</span><span class="s5">0</span><span class="s1">] + style.NAME_SPACING</span>
        <span class="s1">self._name_element.set_center((</span><span class="s3">None, </span><span class="s1">y))</span>
        <span class="s1">self._name_element.set_topleft((l</span><span class="s3">, None</span><span class="s1">))</span>

    <span class="s3">def </span><span class="s1">get_storer_rect(self):</span>
        <span class="s3">return </span><span class="s1">self.get_family_rect(constants.STATE_NORMAL)</span>

    <span class="s3">def </span><span class="s1">get_value(self):</span>
        <span class="s3">try</span><span class="s1">:</span>
            <span class="s3">return </span><span class="s1">self._value_type(self._inserted)</span>
        <span class="s3">except </span><span class="s1">ValueError:</span>
            <span class="s1">functions.debug_msg(</span><span class="s4">&quot;type of self._inserted is not &quot; </span><span class="s1">+ \</span>
                                <span class="s1">str(self._value_type))</span>
            <span class="s3">return </span><span class="s1">self._value_type()</span>

    <span class="s3">def </span><span class="s1">set_value(self</span><span class="s3">, </span><span class="s1">value</span><span class="s3">, </span><span class="s1">refresh_draw=</span><span class="s3">False</span><span class="s1">):</span>
        <span class="s1">self.make_small_enough(value)</span>
        <span class="s3">if </span><span class="s1">self._iwriter._is_small_enough(value):</span>
            <span class="s1">self._inserted = value</span>
            <span class="s1">self._cursor_index = len(value)</span>
            <span class="s1">self._urbu(graphical=refresh_draw)</span>
        <span class="s3">else</span><span class="s1">:</span>
            <span class="s1">self.set_size(self._iwriter.get_rect().size)</span>
            <span class="s2">#raise Exception(&quot;Cannot insert value in inserter:&quot;, value)</span>

    <span class="s3">def </span><span class="s1">set_font_color(self</span><span class="s3">, </span><span class="s1">color</span><span class="s3">, </span><span class="s1">state=</span><span class="s3">None, </span><span class="s1">center_title=</span><span class="s3">True</span><span class="s1">):</span>
        <span class="s0">&quot;&quot;&quot;set font color for a given state&quot;&quot;&quot;</span>
        <span class="s1">Clickable.set_font_color(self</span><span class="s3">, </span><span class="s1">color</span><span class="s3">, </span><span class="s1">state</span><span class="s3">, </span><span class="s1">center_title)</span>
        <span class="s1">self._name_element.set_font_color(color</span><span class="s3">, </span><span class="s1">state</span><span class="s3">, </span><span class="s1">center_title)</span>

    <span class="s3">def </span><span class="s1">set_font_size(self</span><span class="s3">, </span><span class="s1">size</span><span class="s3">, </span><span class="s1">state=</span><span class="s3">None, </span><span class="s1">center_title=</span><span class="s3">True</span><span class="s1">):</span>
        <span class="s0">&quot;&quot;&quot;set font color for a given state&quot;&quot;&quot;</span>
        <span class="s1">Clickable.set_font_size(self</span><span class="s3">, </span><span class="s1">size</span><span class="s3">, </span><span class="s1">state</span><span class="s3">, </span><span class="s1">center_title)</span>
        <span class="s1">self._name_element.set_font_size(size</span><span class="s3">, </span><span class="s1">state</span><span class="s3">, </span><span class="s1">center_title)</span>

    <span class="s3">def </span><span class="s1">set_font(self</span><span class="s3">, </span><span class="s1">fontname</span><span class="s3">, </span><span class="s1">state=</span><span class="s3">None, </span><span class="s1">center_title=</span><span class="s3">True</span><span class="s1">):</span>
        <span class="s0">&quot;&quot;&quot;set font for a given state&quot;&quot;&quot;</span>
        <span class="s1">Element.set_font(self</span><span class="s3">, </span><span class="s1">fontname</span><span class="s3">, </span><span class="s1">state</span><span class="s3">, </span><span class="s1">center_title)</span>
        <span class="s1">self.set_hovered_states(self._states_hover)</span>

    <span class="s3">def </span><span class="s1">set_font_effects(self</span><span class="s3">, </span><span class="s1">biu</span><span class="s3">, </span><span class="s1">state=</span><span class="s3">None, </span><span class="s1">center=</span><span class="s3">True, </span><span class="s1">preserve=</span><span class="s3">False</span><span class="s1">):</span>
        <span class="s0">&quot;&quot;&quot;biu = tuple : (bold, italic, underline)&quot;&quot;&quot;</span>
        <span class="s1">CLickable.set_font_effects(self</span><span class="s3">, </span><span class="s1">bio</span><span class="s3">, </span><span class="s1">state</span><span class="s3">, </span><span class="s1">center</span><span class="s3">, </span><span class="s1">preserve)</span>
        <span class="s1">self._name_element.set_font_effects(biu</span><span class="s3">, </span><span class="s1">state</span><span class="s3">, </span><span class="s1">center</span><span class="s3">, </span><span class="s1">preserve)</span>

    <span class="s3">def </span><span class="s1">get_help_rect(self):</span>
        <span class="s3">return </span><span class="s1">self._name_element.get_help_rect()</span>

    <span class="s3">def </span><span class="s1">get_text(self):</span>
        <span class="s3">return </span><span class="s1">self._name_element.get_text()</span>

    <span class="s3">def </span><span class="s1">set_active(self</span><span class="s3">, </span><span class="s1">value):</span>
        <span class="s1">self.active = value </span><span class="s2">#deactivate text insertion</span>
        <span class="s1">self.cursor.active = value </span><span class="s2">#deactivate cursor</span>
        <span class="s1">self._name_element.active = value </span><span class="s2">#deactivate hoverable title</span>

    <span class="s3">def </span><span class="s1">set_visible(self</span><span class="s3">, </span><span class="s1">value):</span>
        <span class="s1">self.visible = value </span><span class="s2">#deactivate text insertion</span>
        <span class="s1">self.cursor.visible = value </span><span class="s2">#deactivate cursor</span>
        <span class="s1">self._name_element.visible = value </span><span class="s2">#deactivate hoverable title</span>

<span class="s2">##    def reac_click(self, e):</span>

</pre>
</body>
</html>